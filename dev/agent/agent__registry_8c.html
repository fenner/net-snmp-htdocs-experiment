---
section: development
---
<!-- CONTENT START -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>agent_registry.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>agent_registry.c File Reference</h1><code>#include &lt;<a class="el" href="config_8h-source.html">config.h</a>&gt;</code><br>
<code>#include &lt;signal.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;fcntl.h&gt;</code><br>
<code>#include &lt;sys/time.h&gt;</code><br>
<code>#include &lt;time.h&gt;</code><br>
<code>#include &lt;dmalloc.h&gt;</code><br>
<code>#include "mibincl.h"</code><br>
<code>#include "snmp_client.h"</code><br>
<code>#include "default_store.h"</code><br>
<code>#include "<a class="el" href="ds__agent_8h-source.html">ds_agent.h</a>"</code><br>
<code>#include "callback.h"</code><br>
<code>#include "<a class="el" href="agent__callbacks_8h-source.html">agent_callbacks.h</a>"</code><br>
<code>#include "<a class="el" href="agent__registry_8h-source.html">agent_registry.h</a>"</code><br>
<code>#include "snmp_alarm.h"</code><br>
<code>#include "snmp_secmod.h"</code><br>
<code>#include "vacm.h"</code><br>
<code>#include "<a class="el" href="snmpd_8h-source.html">snmpd.h</a>"</code><br>
<code>#include "mibgroup/struct.h"</code><br>
<code>#include "<a class="el" href="old__api_8h-source.html">helpers/old_api.h</a>"</code><br>
<code>#include "<a class="el" href="null_8h-source.html">helpers/null.h</a>"</code><br>
<code>#include "<a class="el" href="table_8h-source.html">helpers/table.h</a>"</code><br>
<code>#include "<a class="el" href="table__iterator_8h-source.html">helpers/table_iterator.h</a>"</code><br>
<code>#include "mib_module_includes.h"</code><br>

<p>
<a href="agent__registry_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a0">IN_SNMP_VARS_C</a></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="agent__registry_8h.html#a31">subtree_context_cache</a> *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a17">get_top_context_cache</a> (void)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a18">find_first_subtree</a> (const char *context_name)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a19">add_subtree</a> (struct <a class="el" href="structsubtree.html">subtree</a> *new_tree, const char *context_name)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a20">replace_first_subtree</a> (struct <a class="el" href="structsubtree.html">subtree</a> *new_tree, const char *context_name)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a21">tree_compare</a> (const struct <a class="el" href="structsubtree.html">subtree</a> *ap, const struct <a class="el" href="structsubtree.html">subtree</a> *bp)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a22">split_subtree</a> (struct <a class="el" href="structsubtree.html">subtree</a> *current, oid name[], int name_len)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a23">load_subtree</a> (struct <a class="el" href="structsubtree.html">subtree</a> *new_sub, const char *context_name)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a24">register_mib_context2</a> (const char *moduleName, struct <a class="el" href="structvariable.html">variable</a> *var, size_t varsize, size_t numvars, oid *mibloc, size_t mibloclen, int priority, int range_subid, oid range_ubound, struct snmp_session *ss, const char *context, int timeout, int flags, <a class="el" href="helpers_2agent__handler_8h.html#a9">handler_registration</a> *reginfo)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a25">register_mib_context</a> (const char *moduleName, struct <a class="el" href="structvariable.html">variable</a> *var, size_t varsize, size_t numvars, oid *mibloc, size_t mibloclen, int priority, int range_subid, oid range_ubound, struct snmp_session *ss, const char *context, int timeout, int flags)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a26">register_mib_reattach_subtree</a> (struct <a class="el" href="structsubtree.html">subtree</a> *it)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a27">register_mib_reattach</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a28">register_mib_range</a> (const char *moduleName, struct <a class="el" href="structvariable.html">variable</a> *var, size_t varsize, size_t numvars, oid *mibloc, size_t mibloclen, int priority, int range_subid, oid range_ubound, struct snmp_session *ss)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a29">register_mib_priority</a> (const char *moduleName, struct <a class="el" href="structvariable.html">variable</a> *var, size_t varsize, size_t numvars, oid *mibloc, size_t mibloclen, int priority)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a30">register_mib</a> (const char *moduleName, struct <a class="el" href="structvariable.html">variable</a> *var, size_t varsize, size_t numvars, oid *mibloc, size_t mibloclen)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a31">register_mib_table_row</a> (const char *moduleName, struct <a class="el" href="structvariable.html">variable</a> *var, size_t varsize, size_t numvars, oid *mibloc, size_t mibloclen, int priority, int var_subid, struct snmp_session *ss, const char *context, int timeout, int flags)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a32">unload_subtree</a> (struct <a class="el" href="structsubtree.html">subtree</a> *sub, struct <a class="el" href="structsubtree.html">subtree</a> *prev)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a33">unregister_mib_context</a> (oid *name, size_t len, int priority, int range_subid, oid range_ubound, const char *context)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a34">unregister_mib_range</a> (oid *name, size_t len, int priority, int range_subid, oid range_ubound)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a35">unregister_mib_priority</a> (oid *name, size_t len, int priority)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a36">unregister_mib</a> (oid *name, size_t len)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a37">unregister_mibs_by_session</a> (struct snmp_session *ss)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a38">free_subtree</a> (struct <a class="el" href="structsubtree.html">subtree</a> *st)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a39">in_a_view</a> (oid *name, size_t *namelen, struct snmp_pdu *pdu, int type)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a40">check_access</a> (struct snmp_pdu *pdu)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a41">compare_tree</a> (const oid *in_name1, size_t len1, const oid *in_name2, size_t len2)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a42">find_subtree_previous</a> (oid *name, size_t len, struct <a class="el" href="structsubtree.html">subtree</a> *<a class="el" href="structsubtree.html">subtree</a>, const char *context_name)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a43">find_subtree_next</a> (oid *name, size_t len, struct <a class="el" href="structsubtree.html">subtree</a> *<a class="el" href="structsubtree.html">subtree</a>, const char *context_name)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a44">find_subtree</a> (oid *name, size_t len, struct <a class="el" href="structsubtree.html">subtree</a> *<a class="el" href="structsubtree.html">subtree</a>, const char *context_name)</td></tr>
<tr><td nowrap align=right valign=top>snmp_session *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a45">get_session_for_oid</a> (oid *name, size_t len, const char *context_name)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a46">setup_tree</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a47">dump_idx_registry</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a48">dump_registry</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a49">register_readfd</a> (int fd, void(*func)(int, void *), void *data)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a50">register_writefd</a> (int fd, void(*func)(int, void *), void *data)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a51">register_exceptfd</a> (int fd, void(*func)(int, void *), void *data)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a52">unregister_readfd</a> (int fd)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a53">unregister_writefd</a> (int fd)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a54">unregister_exceptfd</a> (int fd)</td></tr>
<tr><td nowrap align=right valign=top>RETSIGTYPE&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a55">agent_SIGCHLD_handler</a> (int sig)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a56">register_signal</a> (int sig, void(*func)(int))</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a57">unregister_signal</a> (int sig)</td></tr>
<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="agent__registry_8h.html#a31">subtree_context_cache</a> *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a1">context_subtrees</a> = NULL</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a3">external_readfd</a> [NUM_EXTERNAL_FDS]</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a4">external_readfdlen</a> = 0</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a5">external_writefd</a> [NUM_EXTERNAL_FDS]</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a6">external_writefdlen</a> = 0</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a7">external_exceptfd</a> [NUM_EXTERNAL_FDS]</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a8">external_exceptfdlen</a> = 0</td></tr>
<tr><td nowrap align=right valign=top>void(*&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a9">external_readfdfunc</a> [NUM_EXTERNAL_FDS])(int, void *)</td></tr>
<tr><td nowrap align=right valign=top>void(*&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a10">external_writefdfunc</a> [NUM_EXTERNAL_FDS])(int, void *)</td></tr>
<tr><td nowrap align=right valign=top>void(*&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a11">external_exceptfdfunc</a> [NUM_EXTERNAL_FDS])(int, void *)</td></tr>
<tr><td nowrap align=right valign=top>void *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a12">external_readfd_data</a> [NUM_EXTERNAL_FDS]</td></tr>
<tr><td nowrap align=right valign=top>void *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a13">external_writefd_data</a> [NUM_EXTERNAL_FDS]</td></tr>
<tr><td nowrap align=right valign=top>void *&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a14">external_exceptfd_data</a> [NUM_EXTERNAL_FDS]</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a15">external_signal_scheduled</a> [NUM_EXTERNAL_SIGS]</td></tr>
<tr><td nowrap align=right valign=top>void(*&nbsp;</td><td valign=bottom><a class="el" href="agent__registry_8c.html#a16">external_signal_handler</a> [NUM_EXTERNAL_SIGS])(int)</td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a name="a0" doxytag="agent_registry.c::IN_SNMP_VARS_C"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IN_SNMP_VARS_C
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00008">8</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a name="a19" doxytag="agent_registry.c::add_subtree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structsubtree.html">subtree</a>* add_subtree </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>new_tree</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>context_name</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00090">90</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.
<p>
Referenced by <a class="el" href="agent__registry_8c-source.html#l00107">replace_first_subtree</a>().
<p>
<div class="fragment"><pre>00090                                                                 {
00091     <a class="code" href="structsubtree__context__cache__s.html">subtree_context_cache</a> *ptr = SNMP_MALLOC_TYPEDEF(<a class="code" href="structsubtree__context__cache__s.html">subtree_context_cache</a>);
00092     <font class="keywordflow">if</font> (!context_name)
00093         context_name = <font class="stringliteral">""</font>;
00094 
00095     <font class="keywordflow">if</font> (!ptr)
00096         <font class="keywordflow">return</font> NULL;
00097 
00098     DEBUGMSGTL((<font class="stringliteral">"add_subtree"</font>,<font class="stringliteral">"adding subtree for context: \"%s\"\n"</font>, context_name));
00099     ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m2">next</a> = <a class="code" href="agent__registry_8c.html#a1">context_subtrees</a>;
00100     ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m1">first_subtree</a> = new_tree;
00101     ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m0">context_name</a> = strdup(context_name);
00102     <a class="code" href="agent__registry_8c.html#a1">context_subtrees</a> = ptr;
00103     <font class="keywordflow">return</font> ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m1">first_subtree</a>;
00104 }
</pre></div>    </td>
  </tr>
</table>
<a name="a55" doxytag="agent_registry.c::agent_SIGCHLD_handler"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> RETSIGTYPE agent_SIGCHLD_handler </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname1">&nbsp; <em>sig</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01172">1172</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>01173 {
01174   external_signal_scheduled[SIGCHLD]++;
01175 <font class="preprocessor">#ifndef HAVE_SIGACTION</font>
01176   <font class="comment">/* signal() sucks. It *might* have SysV semantics, which means that</font>
01177    * a signal handler is reset once it gets called. Ensure that it
01178    * remains active.
01179    */
01180   signal(SIGCHLD, <a class="code" href="agent__registry_8c.html#a55">agent_SIGCHLD_handler</a>);
01181 <font class="preprocessor">#endif</font>
01182 }
</pre></div>    </td>
  </tr>
</table>
<a name="a40" doxytag="agent_registry.c::check_access"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int check_access </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct snmp_pdu *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>pdu</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00866">866</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00867 {
00868   <font class="keyword">struct </font><a class="code" href="structview__parameters.html">view_parameters</a> view_parms;
00869   view_parms.<a class="code" href="structview__parameters.html#m0">pdu</a> = pdu;
00870   view_parms.<a class="code" href="structview__parameters.html#m1">name</a> = 0;
00871   view_parms.<a class="code" href="structview__parameters.html#m2">namelen</a> = 0;
00872   view_parms.<a class="code" href="structview__parameters.html#m3">errorcode</a> = 0;
00873 
00874   <font class="keywordflow">if</font> (pdu-&gt;flags &amp; UCD_MSG_FLAG_ALWAYS_IN_VIEW)
00875     <font class="keywordflow">return</font> 0;           <font class="comment">/* Enable bypassing of view-based access control */</font>
00876 
00877   <font class="keywordflow">switch</font> (pdu-&gt;version) {
00878   <font class="keywordflow">case</font> SNMP_VERSION_1:
00879   <font class="keywordflow">case</font> SNMP_VERSION_2c:
00880   <font class="keywordflow">case</font> SNMP_VERSION_3:
00881     snmp_call_callbacks(SNMP_CALLBACK_APPLICATION,
00882                         <a class="code" href="agent__callbacks_8h.html#a5">SNMPD_CALLBACK_ACM_CHECK_INITIAL</a>,
00883                         &amp;view_parms);
00884     <font class="keywordflow">return</font> view_parms.<a class="code" href="structview__parameters.html#m3">errorcode</a>;
00885   }
00886   <font class="keywordflow">return</font> 1;
00887 }
</pre></div>    </td>
  </tr>
</table>
<a name="a41" doxytag="agent_registry.c::compare_tree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int compare_tree </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>in_name1</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>len1</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>in_name2</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>len2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00897">897</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00901 {
00902     <font class="keyword">register</font> <font class="keywordtype">int</font> len, res;
00903     <font class="keyword">register</font> <font class="keyword">const</font> oid * name1 = in_name1;
00904     <font class="keyword">register</font> <font class="keyword">const</font> oid * name2 = in_name2;
00905 
00906     <font class="comment">/* len = minimum of len1 and len2 */</font>
00907     <font class="keywordflow">if</font> (len1 &lt; len2)
00908         len = len1;
00909     <font class="keywordflow">else</font>
00910         len = len2;
00911     <font class="comment">/* find first non-matching OID */</font>
00912     <font class="keywordflow">while</font>(len-- &gt; 0){
00913         res = *(name1++) - *(name2++);
00914         <font class="keywordflow">if</font> (res &lt; 0)
00915             <font class="keywordflow">return</font> -1;
00916         <font class="keywordflow">if</font> (res &gt; 0)
00917             <font class="keywordflow">return</font> 1;
00918     }
00919     <font class="comment">/* both OIDs equal up to length of shorter OID */</font>
00920     <font class="keywordflow">if</font> (len1 &lt; len2)
00921         <font class="keywordflow">return</font> -1;
00922 
00923     <font class="comment">/* name1 matches name2 for length of name2, or they are equal */</font>
00924     <font class="keywordflow">return</font> 0;
00925 }
</pre></div>    </td>
  </tr>
</table>
<a name="a47" doxytag="agent_registry.c::dump_idx_registry"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void dump_idx_registry </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__index_8c-source.html#l00495">495</a> of file <a class="el" href="agent__index_8c-source.html">agent_index.c</a>.<div class="fragment"><pre>00496 {
00497     <font class="keyword">struct </font><a class="code" href="structsnmp__index.html">snmp_index</a> *idxptr, *idxptr2;
00498     <font class="keywordtype">char</font> start_oid[SPRINT_MAX_LEN];
00499     <font class="keywordtype">char</font> end_oid[SPRINT_MAX_LEN];
00500 
00501     <font class="keywordflow">if</font> ( snmp_index_head )
00502         printf(<font class="stringliteral">"\nIndex Allocations:\n"</font>);
00503     <font class="keywordflow">for</font>( idxptr = <a class="code" href="agent__index_8c.html#a0">snmp_index_head</a> ; idxptr != NULL; idxptr = idxptr-&gt;<a class="code" href="structsnmp__index.html#m2">next_oid</a>) {
00504         sprint_objid(start_oid, idxptr-&gt;<a class="code" href="structsnmp__index.html#m0">varbind</a>-&gt;name, idxptr-&gt;<a class="code" href="structsnmp__index.html#m0">varbind</a>-&gt;name_length);
00505         printf(<font class="stringliteral">"%s indexes:\n"</font>, start_oid);
00506         <font class="keywordflow">for</font>( idxptr2 = idxptr ; idxptr2 != NULL; idxptr2 = idxptr2-&gt;<a class="code" href="structsnmp__index.html#m4">next_idx</a>) {
00507             <font class="keywordflow">switch</font>( idxptr2-&gt;<a class="code" href="structsnmp__index.html#m0">varbind</a>-&gt;type ) {
00508                 <font class="keywordflow">case</font> ASN_INTEGER:
00509                     printf(<font class="stringliteral">"    %c %ld %c\n"</font>,
00510                         ( idxptr2-&gt;<a class="code" href="structsnmp__index.html#m1">session</a> ? <font class="charliteral">' '</font> : <font class="charliteral">'('</font> ),
00511                           *idxptr2-&gt;<a class="code" href="structsnmp__index.html#m0">varbind</a>-&gt;val.integer,
00512                         ( idxptr2-&gt;<a class="code" href="structsnmp__index.html#m1">session</a> ? <font class="charliteral">' '</font> : <font class="charliteral">')'</font> ));
00513                     <font class="keywordflow">break</font>;
00514                 <font class="keywordflow">case</font> ASN_OCTET_STR:
00515                     printf(<font class="stringliteral">"    %c %s %c\n"</font>,
00516                         ( idxptr2-&gt;<a class="code" href="structsnmp__index.html#m1">session</a> ? <font class="charliteral">' '</font> : <font class="charliteral">'('</font> ),
00517                           idxptr2-&gt;<a class="code" href="structsnmp__index.html#m0">varbind</a>-&gt;val.string,
00518                         ( idxptr2-&gt;<a class="code" href="structsnmp__index.html#m1">session</a> ? <font class="charliteral">' '</font> : <font class="charliteral">')'</font> ));
00519                     <font class="keywordflow">break</font>;
00520                 <font class="keywordflow">case</font> ASN_OBJECT_ID:
00521                     sprint_objid(end_oid, idxptr2-&gt;<a class="code" href="structsnmp__index.html#m0">varbind</a>-&gt;val.objid,
00522                                 idxptr2-&gt;<a class="code" href="structsnmp__index.html#m0">varbind</a>-&gt;val_len/<font class="keyword">sizeof</font>(oid));
00523                     printf(<font class="stringliteral">"    %c %s %c\n"</font>,
00524                         ( idxptr2-&gt;<a class="code" href="structsnmp__index.html#m1">session</a> ? <font class="charliteral">' '</font> : <font class="charliteral">'('</font> ),
00525                           end_oid,
00526                         ( idxptr2-&gt;<a class="code" href="structsnmp__index.html#m1">session</a> ? <font class="charliteral">' '</font> : <font class="charliteral">')'</font> ));
00527                     <font class="keywordflow">break</font>;
00528                 <font class="keywordflow">default</font>:
00529                     printf(<font class="stringliteral">"unsupported type (%d)\n"</font>,
00530                                 idxptr2-&gt;<a class="code" href="structsnmp__index.html#m0">varbind</a>-&gt;type);
00531             }
00532         }
00533     }
00534 }
</pre></div>    </td>
  </tr>
</table>
<a name="a48" doxytag="agent_registry.c::dump_registry"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void dump_registry </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01031">1031</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>01032 {
01033     <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *myptr, *myptr2;
01034     <font class="keywordtype">char</font> start_oid[SPRINT_MAX_LEN];
01035     <font class="keywordtype">char</font> end_oid[SPRINT_MAX_LEN];
01036 
01037     <a class="code" href="structsubtree__context__cache__s.html">subtree_context_cache</a> *ptr;
01038     <font class="keywordflow">for</font>(ptr = <a class="code" href="agent__registry_8c.html#a1">context_subtrees</a>; ptr; ptr = ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m2">next</a>) {
01039         printf(<font class="stringliteral">"Subtrees for Context: %s\n"</font>, ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m0">context_name</a>);
01040         <font class="keywordflow">for</font>( myptr = ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m1">first_subtree</a> ; myptr != NULL; myptr = myptr-&gt;<a class="code" href="structsubtree.html#m14">next</a>) {
01041             sprint_objid(start_oid, myptr-&gt;<a class="code" href="structsubtree.html#m2">start</a>, myptr-&gt;<a class="code" href="structsubtree.html#m3">start_len</a>);
01042             sprint_objid(end_oid, myptr-&gt;<a class="code" href="structsubtree.html#m4">end</a>, myptr-&gt;<a class="code" href="structsubtree.html#m5">end_len</a>);
01043             printf(<font class="stringliteral">"%s%c %s - %s %c\n"</font>,
01044                    (myptr-&gt;<a class="code" href="structsubtree.html#m11">flags</a> &amp; <a class="code" href="var__struct_8h.html#a1">FULLY_QUALIFIED_INSTANCE</a>)?<font class="stringliteral">"[FQI] "</font>:<font class="stringliteral">""</font>,
01045                    ( myptr-&gt;<a class="code" href="structsubtree.html#m6">variables</a> ? <font class="charliteral">' '</font> : <font class="charliteral">'('</font> ),
01046                    start_oid, end_oid,
01047                    ( myptr-&gt;<a class="code" href="structsubtree.html#m6">variables</a> ? <font class="charliteral">' '</font> : <font class="charliteral">')'</font> ));
01048             <font class="keywordflow">for</font>( myptr2 = myptr ; myptr2 != NULL; myptr2 = myptr2-&gt;<a class="code" href="structsubtree.html#m16">children</a>) {
01049                 <font class="keywordflow">if</font> ( myptr2-&gt;<a class="code" href="structsubtree.html#m9">label</a> &amp;&amp; myptr2-&gt;<a class="code" href="structsubtree.html#m9">label</a>[0] )
01050                     printf(<font class="stringliteral">"\t%s\n"</font>, myptr2-&gt;<a class="code" href="structsubtree.html#m9">label</a>);
01051             }
01052         }
01053     }
01054 
01055     <a class="code" href="agent__index_8c.html#a10">dump_idx_registry</a>();
01056 }
</pre></div>    </td>
  </tr>
</table>
<a name="a18" doxytag="agent_registry.c::find_first_subtree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structsubtree.html">subtree</a>* find_first_subtree </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>context_name</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00074">74</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00074                                              {
00075     <a class="code" href="structsubtree__context__cache__s.html">subtree_context_cache</a> *ptr;
00076     <font class="keywordflow">if</font> (!context_name)
00077         context_name = <font class="stringliteral">""</font>;
00078     DEBUGMSGTL((<font class="stringliteral">"find_first_subtree"</font>,<font class="stringliteral">"looking for subtree for context: \"%s\"\n"</font>, context_name));
00079     <font class="keywordflow">for</font>(ptr = <a class="code" href="agent__registry_8c.html#a1">context_subtrees</a>; ptr; ptr = ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m2">next</a>) {
00080         <font class="keywordflow">if</font> (strcmp(ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m0">context_name</a>, context_name) == 0)<font class="keyword"> </font>{
00081             DEBUGMSGTL((<font class="stringliteral">"find_first_subtree"</font>,<font class="stringliteral">"found one for: \"%s\"\n"</font>, context_name));
00082             <font class="keywordflow">return</font> ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m1">first_subtree</a>;
00083         }
00084     }
00085     DEBUGMSGTL((<font class="stringliteral">"find_first_subtree"</font>,<font class="stringliteral">"Didn't find a subtree for: \"%s\"\n"</font>, context_name));
00086     <font class="keywordflow">return</font> NULL;
00087 }
</pre></div>    </td>
  </tr>
</table>
<a name="a44" doxytag="agent_registry.c::find_subtree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structsubtree.html">subtree</a>* find_subtree </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>len</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>subtree</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>context_name</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00967">967</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00971 {
00972   <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *myptr;
00973 
00974   myptr = <a class="code" href="agent__registry_8h.html#a35">find_subtree_previous</a>(name, len, <a class="code" href="structsubtree.html">subtree</a>, context_name);
00975   <font class="keywordflow">if</font> (myptr &amp;&amp; snmp_oid_compare(name, len, myptr-&gt;<a class="code" href="structsubtree.html#m4">end</a>, myptr-&gt;<a class="code" href="structsubtree.html#m5">end_len</a>) &lt; 0)
00976         <font class="keywordflow">return</font> myptr;
00977 
00978   <font class="keywordflow">return</font> NULL;
00979 }
</pre></div>    </td>
  </tr>
</table>
<a name="a43" doxytag="agent_registry.c::find_subtree_next"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structsubtree.html">subtree</a>* find_subtree_next </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>len</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>subtree</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>context_name</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00947">947</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00951 {
00952   <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *myptr = NULL;
00953 
00954   myptr = <a class="code" href="agent__registry_8h.html#a35">find_subtree_previous</a>(name, len, <a class="code" href="structsubtree.html">subtree</a>, context_name);
00955   <font class="keywordflow">if</font> ( myptr != NULL ) {
00956      myptr = myptr-&gt;<a class="code" href="structsubtree.html#m14">next</a>;
00957      <font class="keywordflow">while</font> ( myptr &amp;&amp; (myptr-&gt;<a class="code" href="structsubtree.html#m6">variables</a> == NULL || myptr-&gt;<a class="code" href="structsubtree.html#m7">variables_len</a> == 0) )
00958          myptr = myptr-&gt;<a class="code" href="structsubtree.html#m14">next</a>;
00959      <font class="keywordflow">return</font> myptr;
00960   }
00961   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="structsubtree.html">subtree</a> &amp;&amp; snmp_oid_compare(name, len, subtree-&gt;<a class="code" href="structsubtree.html#m2">start</a>, subtree-&gt;<a class="code" href="structsubtree.html#m3">start_len</a>) &lt; 0)
00962      <font class="keywordflow">return</font> <a class="code" href="structsubtree.html">subtree</a>;
00963   <font class="keywordflow">else</font>
00964      <font class="keywordflow">return</font> NULL;
00965 }
</pre></div>    </td>
  </tr>
</table>
<a name="a42" doxytag="agent_registry.c::find_subtree_previous"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structsubtree.html">subtree</a>* find_subtree_previous </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>len</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>subtree</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>context_name</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00927">927</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00931 {
00932   <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *myptr, *previous = NULL;
00933 
00934   <font class="keywordflow">if</font> ( subtree )
00935         myptr = <a class="code" href="structsubtree.html">subtree</a>;
00936   <font class="keywordflow">else</font>
00937         myptr = <a class="code" href="agent__registry_8h.html#a60">find_first_subtree</a>(context_name);  <font class="comment">/* look through everything */</font>
00938 
00939   <font class="keywordflow">for</font>( ; myptr != NULL; previous = myptr, myptr = myptr-&gt;<a class="code" href="structsubtree.html#m14">next</a>) {
00940     <font class="keywordflow">if</font> (snmp_oid_compare(name, len, myptr-&gt;<a class="code" href="structsubtree.html#m2">start</a>, myptr-&gt;<a class="code" href="structsubtree.html#m3">start_len</a>) &lt; 0)<font class="keyword"> </font>{
00941       <font class="keywordflow">return</font> previous;
00942     }
00943   }
00944   <font class="keywordflow">return</font> previous;
00945 }
</pre></div>    </td>
  </tr>
</table>
<a name="a38" doxytag="agent_registry.c::free_subtree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structsubtree.html">subtree</a>* free_subtree </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>st</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00806">806</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00807 {
00808   <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *ret = NULL;
00809 
00810   <font class="keywordflow">if</font> (st-&gt;<a class="code" href="structsubtree.html#m6">variables</a> != NULL &amp;&amp;
00811       snmp_oid_compare(st-&gt;<a class="code" href="structsubtree.html#m0">name</a>, st-&gt;<a class="code" href="structsubtree.html#m1">namelen</a>, st-&gt;<a class="code" href="structsubtree.html#m2">start</a>, st-&gt;<a class="code" href="structsubtree.html#m3">start_len</a>) == 0)<font class="keyword"> </font>{
00812     free(st-&gt;<a class="code" href="structsubtree.html#m6">variables</a>);
00813     st-&gt;<a class="code" href="structsubtree.html#m6">variables</a> = NULL;
00814   }
00815   <font class="keywordflow">if</font> (st-&gt;<a class="code" href="structsubtree.html#m14">next</a> != NULL) {
00816     ret = st-&gt;<a class="code" href="structsubtree.html#m14">next</a>;
00817   }
00818   free(st);
00819   <font class="keywordflow">return</font> ret;
00820 }
</pre></div>    </td>
  </tr>
</table>
<a name="a45" doxytag="agent_registry.c::get_session_for_oid"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct snmp_session* get_session_for_oid </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>len</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>context_name</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00981">981</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00983 {
00984    <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *myptr;
00985 
00986    myptr = <a class="code" href="agent__registry_8h.html#a35">find_subtree_previous</a>(name, len, <a class="code" href="agent__registry_8h.html#a60">find_first_subtree</a>(context_name),
00987                                  context_name);
00988    <font class="keywordflow">while</font> ( myptr &amp;&amp; myptr-&gt;<a class="code" href="structsubtree.html#m6">variables</a> == NULL )
00989         myptr = myptr-&gt;<a class="code" href="structsubtree.html#m14">next</a>;
00990 
00991    <font class="keywordflow">if</font> ( myptr == NULL )
00992         <font class="keywordflow">return</font> NULL;
00993    <font class="keywordflow">else</font>
00994         <font class="keywordflow">return</font> myptr-&gt;<a class="code" href="structsubtree.html#m10">session</a>;
00995 }
</pre></div>    </td>
  </tr>
</table>
<a name="a17" doxytag="agent_registry.c::get_top_context_cache"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="agent__registry_8h.html#a31">subtree_context_cache</a>* get_top_context_cache </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00069">69</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00069                                                    {
00070     <font class="keywordflow">return</font> <a class="code" href="agent__registry_8c.html#a1">context_subtrees</a>;
00071 }
</pre></div>    </td>
  </tr>
</table>
<a name="a39" doxytag="agent_registry.c::in_a_view"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int in_a_view </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t *&nbsp;</td>
          <td class="mdname">&nbsp; <em>namelen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct snmp_pdu *&nbsp;</td>
          <td class="mdname">&nbsp; <em>pdu</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>type</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00831">831</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00835 {
00836 
00837   <font class="keyword">struct </font><a class="code" href="structview__parameters.html">view_parameters</a> view_parms;
00838   view_parms.<a class="code" href="structview__parameters.html#m0">pdu</a> = pdu;
00839   view_parms.<a class="code" href="structview__parameters.html#m1">name</a> = name;
00840   <font class="keywordflow">if</font> (namelen)
00841       view_parms.<a class="code" href="structview__parameters.html#m2">namelen</a> = *namelen;
00842   <font class="keywordflow">else</font>
00843       view_parms.<a class="code" href="structview__parameters.html#m2">namelen</a> = 0;
00844   view_parms.<a class="code" href="structview__parameters.html#m3">errorcode</a> = 0;
00845 
00846   <font class="keywordflow">if</font> (pdu-&gt;flags &amp; UCD_MSG_FLAG_ALWAYS_IN_VIEW)
00847     <font class="keywordflow">return</font> VACM_SUCCESS; <font class="comment">/* Enable bypassing of view-based access control */</font>
00848 
00849   <font class="comment">/* check for v1 and counter64s, since snmpv1 doesn't support it */</font>
00850   <font class="keywordflow">if</font> (pdu-&gt;version == SNMP_VERSION_1 &amp;&amp; type == ASN_COUNTER64)
00851     <font class="keywordflow">return</font> VACM_NOTINVIEW;
00852   <font class="keywordflow">switch</font> (pdu-&gt;version) {
00853   <font class="keywordflow">case</font> SNMP_VERSION_1:
00854   <font class="keywordflow">case</font> SNMP_VERSION_2c:
00855   <font class="keywordflow">case</font> SNMP_VERSION_3:
00856     snmp_call_callbacks(SNMP_CALLBACK_APPLICATION, <a class="code" href="agent__callbacks_8h.html#a0">SNMPD_CALLBACK_ACM_CHECK</a>,
00857                         &amp;view_parms);
00858     <font class="keywordflow">return</font> view_parms.<a class="code" href="structview__parameters.html#m3">errorcode</a>;
00859   }
00860   <font class="keywordflow">return</font> VACM_NOSECNAME;
00861 }
</pre></div>    </td>
  </tr>
</table>
<a name="a23" doxytag="agent_registry.c::load_subtree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int load_subtree </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>new_sub</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>context_name</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00203">203</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.
<p>
Referenced by <a class="el" href="agent__registry_8c-source.html#l00355">register_mib_context2</a>(), and <a class="el" href="agent__registry_8c-source.html#l00578">register_mib_table_row</a>().
<p>
<div class="fragment"><pre>00204 {
00205     <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *tree1, *tree2, *new2;
00206     <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *prev, *next;
00207     <font class="keywordtype">int</font> res;
00208 
00209     <font class="keywordflow">if</font> ( new_sub == NULL )
00210         <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a0">MIB_REGISTERED_OK</a>;       <font class="comment">/* Degenerate case */</font>
00211 
00212                 <font class="comment">/*</font>
00213                  * Find the subtree that contains the start of 
00214                  *  the new subtree (if any)...
00215                  */
00216     tree1 = <a class="code" href="agent__registry_8h.html#a33">find_subtree</a>( new_sub-&gt;<a class="code" href="structsubtree.html#m2">start</a>, new_sub-&gt;<a class="code" href="structsubtree.html#m3">start_len</a>, NULL,
00217                           context_name );
00218                 <font class="comment">/*</font>
00219                  * ...and the subtree that follows the new one
00220                  *      (NULL implies this is the final region covered)
00221                  */  
00222     <font class="keywordflow">if</font> ( tree1 == NULL )
00223         tree2 = <a class="code" href="agent__registry_8h.html#a34">find_subtree_next</a>( new_sub-&gt;<a class="code" href="structsubtree.html#m2">start</a>, new_sub-&gt;<a class="code" href="structsubtree.html#m3">start_len</a>, NULL,
00224                                    context_name);
00225     <font class="keywordflow">else</font>
00226         tree2 = tree1-&gt;<a class="code" href="structsubtree.html#m14">next</a>;
00227 
00228 
00229         <font class="comment">/*</font>
00230          * Handle new subtrees that start in virgin territory.
00231          */
00232     <font class="keywordflow">if</font> ( tree1 == NULL ) {
00233         new2 = NULL;
00234                 <font class="comment">/* Is there any overlap with later subtrees ? */</font>
00235         <font class="keywordflow">if</font> ( tree2 &amp;&amp; snmp_oid_compare( new_sub-&gt;<a class="code" href="structsubtree.html#m4">end</a>, new_sub-&gt;<a class="code" href="structsubtree.html#m5">end_len</a>,
00236                                         tree2-&gt;<a class="code" href="structsubtree.html#m2">start</a>, tree2-&gt;<a class="code" href="structsubtree.html#m3">start_len</a> ) &gt; 0 )
00237             new2 = <a class="code" href="agent__registry_8c.html#a22">split_subtree</a>( new_sub, tree2-&gt;<a class="code" href="structsubtree.html#m2">start</a>, tree2-&gt;<a class="code" href="structsubtree.html#m3">start_len</a> );
00238                 <font class="comment">/*</font>
00239                  * Link the new subtree (less any overlapping region)
00240                  *  with the list of existing registrations
00241                  */
00242         <font class="keywordflow">if</font> ( tree2 ) {
00243             new_sub-&gt;<a class="code" href="structsubtree.html#m15">prev</a> = tree2-&gt;<a class="code" href="structsubtree.html#m15">prev</a>;
00244             tree2-&gt;<a class="code" href="structsubtree.html#m15">prev</a>       = new_sub;
00245         }
00246         <font class="keywordflow">else</font>
00247             new_sub-&gt;<a class="code" href="structsubtree.html#m15">prev</a> = <a class="code" href="agent__registry_8h.html#a35">find_subtree_previous</a>( new_sub-&gt;<a class="code" href="structsubtree.html#m2">start</a>, new_sub-&gt;<a class="code" href="structsubtree.html#m3">start_len</a>, NULL, context_name );
00248 
00249         <font class="keywordflow">if</font> ( new_sub-&gt;<a class="code" href="structsubtree.html#m15">prev</a> )
00250             new_sub-&gt;<a class="code" href="structsubtree.html#m15">prev</a>-&gt;<a class="code" href="structsubtree.html#m14">next</a> = new_sub;
00251         <font class="keywordflow">else</font>
00252             <a class="code" href="agent__registry_8c.html#a20">replace_first_subtree</a>(new_sub, context_name);
00253 
00254         new_sub-&gt;<a class="code" href="structsubtree.html#m14">next</a>     = tree2;
00255 
00256                 <font class="comment">/*</font>
00257                  * If there was any overlap,
00258                  *  recurse to merge in the overlapping region
00259                  *  (including anything that may follow the overlap)
00260                  */
00261         <font class="keywordflow">if</font> ( new2 )
00262             <font class="keywordflow">return</font> <a class="code" href="agent__registry_8c.html#a23">load_subtree</a>( new2, context_name );
00263     }
00264 
00265     <font class="keywordflow">else</font> {
00266         <font class="comment">/*</font>
00267          *  If the new subtree starts *within* an existing registration
00268          *    (rather than at the same point as it), then split the
00269          *    existing subtree at this point.
00270          */
00271         <font class="keywordflow">if</font> ( snmp_oid_compare( new_sub-&gt;<a class="code" href="structsubtree.html#m2">start</a>, new_sub-&gt;<a class="code" href="structsubtree.html#m3">start_len</a>, 
00272                                tree1-&gt;<a class="code" href="structsubtree.html#m2">start</a>,   tree1-&gt;<a class="code" href="structsubtree.html#m3">start_len</a>) != 0 )
00273             tree1 = <a class="code" href="agent__registry_8c.html#a22">split_subtree</a>( tree1, new_sub-&gt;<a class="code" href="structsubtree.html#m2">start</a>, new_sub-&gt;<a class="code" href="structsubtree.html#m3">start_len</a>);
00274             <font class="keywordflow">if</font> ( tree1 == NULL )
00275                 <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a2">MIB_REGISTRATION_FAILED</a>;
00276 
00277         <font class="comment">/*  Now consider the end of this existing subtree:</font>
00278          *      If it matches the new subtree precisely,
00279          *        simply merge the new one into the list of children
00280          *      If it includes the whole of the new subtree,
00281          *        split it at the appropriate point, and merge again
00282          *
00283          *      If the new subtree extends beyond this existing region,
00284          *        split it, and recurse to merge the two parts.
00285          */
00286 
00287          <font class="keywordflow">switch</font> ( snmp_oid_compare( new_sub-&gt;<a class="code" href="structsubtree.html#m4">end</a>, new_sub-&gt;<a class="code" href="structsubtree.html#m5">end_len</a>, 
00288                                     tree1-&gt;<a class="code" href="structsubtree.html#m4">end</a>,   tree1-&gt;<a class="code" href="structsubtree.html#m5">end_len</a>))<font class="keyword">  </font>{
00289 
00290                 <font class="keywordflow">case</font> -1:        <font class="comment">/* Existing subtree contains new one */</font>
00291                         (void) <a class="code" href="agent__registry_8c.html#a22">split_subtree</a>( tree1,
00292                                         new_sub-&gt;<a class="code" href="structsubtree.html#m4">end</a>, new_sub-&gt;<a class="code" href="structsubtree.html#m5">end_len</a>);
00293                         <font class="comment">/* Fall Through */</font>
00294 
00295                 <font class="keywordflow">case</font>  0:        <font class="comment">/* The two trees match precisely */</font>
00296                         <font class="comment">/*</font>
00297                          * Note: This is the only point where the original
00298                          *       registration OID ("name") is used
00299                          */
00300                         prev = NULL;
00301                         next = tree1;
00302                         <font class="keywordflow">while</font> ( next &amp;&amp; next-&gt;<a class="code" href="structsubtree.html#m1">namelen</a> &gt; new_sub-&gt;<a class="code" href="structsubtree.html#m1">namelen</a> ) {
00303                                 prev = next;
00304                                 next = next-&gt;<a class="code" href="structsubtree.html#m16">children</a>;
00305                         }
00306                         <font class="keywordflow">while</font> ( next &amp;&amp; next-&gt;<a class="code" href="structsubtree.html#m1">namelen</a> == new_sub-&gt;<a class="code" href="structsubtree.html#m1">namelen</a> &amp;&amp;
00307                                         next-&gt;<a class="code" href="structsubtree.html#m12">priority</a> &lt; new_sub-&gt;<a class="code" href="structsubtree.html#m12">priority</a> ) {
00308                                 prev = next;
00309                                 next = next-&gt;<a class="code" href="structsubtree.html#m16">children</a>;
00310                         }
00311                         <font class="keywordflow">if</font> ( next &amp;&amp;    next-&gt;<a class="code" href="structsubtree.html#m1">namelen</a>  == new_sub-&gt;<a class="code" href="structsubtree.html#m1">namelen</a> &amp;&amp;
00312                                         next-&gt;<a class="code" href="structsubtree.html#m12">priority</a> == new_sub-&gt;<a class="code" href="structsubtree.html#m12">priority</a> )
00313                            <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a1">MIB_DUPLICATE_REGISTRATION</a>;
00314 
00315                         <font class="keywordflow">if</font> ( prev ) {
00316                             new_sub-&gt;<a class="code" href="structsubtree.html#m16">children</a> = next;
00317                             prev-&gt;<a class="code" href="structsubtree.html#m16">children</a>    = new_sub;
00318                             new_sub-&gt;<a class="code" href="structsubtree.html#m15">prev</a> = prev-&gt;<a class="code" href="structsubtree.html#m15">prev</a>;
00319                             new_sub-&gt;<a class="code" href="structsubtree.html#m14">next</a> = prev-&gt;<a class="code" href="structsubtree.html#m14">next</a>;
00320                         }
00321                         <font class="keywordflow">else</font> {
00322                             new_sub-&gt;<a class="code" href="structsubtree.html#m16">children</a> = next;
00323                             new_sub-&gt;<a class="code" href="structsubtree.html#m15">prev</a> = next-&gt;<a class="code" href="structsubtree.html#m15">prev</a>;
00324                             new_sub-&gt;<a class="code" href="structsubtree.html#m14">next</a> = next-&gt;<a class="code" href="structsubtree.html#m14">next</a>;
00325 
00326                             <font class="keywordflow">for</font> ( next = new_sub-&gt;<a class="code" href="structsubtree.html#m14">next</a> ;
00327                                   next != NULL ;
00328                                   next = next-&gt;<a class="code" href="structsubtree.html#m16">children</a> )
00329                                         next-&gt;<a class="code" href="structsubtree.html#m15">prev</a> = new_sub;
00330 
00331                             <font class="keywordflow">for</font> ( prev = new_sub-&gt;<a class="code" href="structsubtree.html#m15">prev</a> ;
00332                                   prev != NULL ;
00333                                   prev = prev-&gt;<a class="code" href="structsubtree.html#m16">children</a> )
00334                                         prev-&gt;<a class="code" href="structsubtree.html#m14">next</a> = new_sub;
00335                         }
00336                         <font class="keywordflow">break</font>;
00337 
00338                 <font class="keywordflow">case</font>  1:        <font class="comment">/* New subtree contains the existing one */</font>
00339                         new2 = <a class="code" href="agent__registry_8c.html#a22">split_subtree</a>( new_sub,
00340                                         tree1-&gt;<a class="code" href="structsubtree.html#m4">end</a>, tree1-&gt;<a class="code" href="structsubtree.html#m5">end_len</a>);
00341                         res = <a class="code" href="agent__registry_8c.html#a23">load_subtree</a>( new_sub, context_name );
00342                         <font class="keywordflow">if</font> ( res != <a class="code" href="agent__registry_8h.html#a0">MIB_REGISTERED_OK</a> ) {
00343                             <a class="code" href="agent__registry_8h.html#a47">free_subtree</a>(new2);
00344                             <font class="keywordflow">return</font> res;
00345                         }
00346                         <font class="keywordflow">return</font> <a class="code" href="agent__registry_8c.html#a23">load_subtree</a>( new2, context_name );
00347 
00348          }
00349 
00350     }
00351     <font class="keywordflow">return</font> 0;
00352 }
</pre></div>    </td>
  </tr>
</table>
<a name="a51" doxytag="agent_registry.c::register_exceptfd"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_exceptfd </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>fd</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void(*&nbsp;</td>
          <td class="mdname">&nbsp; <em>func</em>)(int, void *), </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname">&nbsp; <em>data</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01097">1097</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>01097                                                                      {
01098     <font class="keywordflow">if</font> (external_exceptfdlen &lt; <a class="code" href="agent__registry_8h.html#a8">NUM_EXTERNAL_FDS</a>) {
01099         external_exceptfd[external_exceptfdlen] = fd;
01100         external_exceptfdfunc[external_exceptfdlen] = func;
01101         external_exceptfd_data[external_exceptfdlen] = data;
01102         external_exceptfdlen++;
01103         DEBUGMSGTL((<font class="stringliteral">"register_exceptfd"</font>, <font class="stringliteral">"registered fd %d\n"</font>, fd));
01104         <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a9">FD_REGISTERED_OK</a>;
01105     } <font class="keywordflow">else</font> {
01106         snmp_log(LOG_CRIT, <font class="stringliteral">"register_exceptfd: too many file descriptors\n"</font>);
01107         <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a10">FD_REGISTRATION_FAILED</a>;
01108     }
01109 }
</pre></div>    </td>
  </tr>
</table>
<a name="a30" doxytag="agent_registry.c::register_mib"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_mib </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>moduleName</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structvariable.html">variable</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>var</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>varsize</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>numvars</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloclen</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00565">565</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00571 {
00572   <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a38">register_mib_priority</a>( moduleName, var, varsize, numvars,
00573                                 mibloc, mibloclen, <a class="code" href="agent__registry_8h.html#a6">DEFAULT_MIB_PRIORITY</a> );
00574 }
</pre></div>    </td>
  </tr>
</table>
<a name="a25" doxytag="agent_registry.c::register_mib_context"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_mib_context </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>moduleName</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structvariable.html">variable</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>var</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>varsize</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>numvars</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloclen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>priority</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>range_subid</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid&nbsp;</td>
          <td class="mdname">&nbsp; <em>range_ubound</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct snmp_session *&nbsp;</td>
          <td class="mdname">&nbsp; <em>ss</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>context</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>timeout</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00481">481</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00493                                 {
00494     <font class="keywordflow">return</font> <a class="code" href="old__api_8h.html#a4">register_old_api</a>(moduleName, var, varsize, numvars, mibloc,
00495                             mibloclen, priority,
00496                             range_subid, range_ubound,
00497                             ss, context, timeout, flags);
00498 }
</pre></div>    </td>
  </tr>
</table>
<a name="a24" doxytag="agent_registry.c::register_mib_context2"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_mib_context2 </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>moduleName</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structvariable.html">variable</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>var</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>varsize</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>numvars</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloclen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>priority</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>range_subid</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid&nbsp;</td>
          <td class="mdname">&nbsp; <em>range_ubound</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct snmp_session *&nbsp;</td>
          <td class="mdname">&nbsp; <em>ss</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>context</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>timeout</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>flags</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="helpers_2agent__handler_8h.html#a9">handler_registration</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>reginfo</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00355">355</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.
<p>
Referenced by <a class="el" href="agent__handler_8c-source.html#l00020">register_handler</a>().
<p>
<div class="fragment"><pre>00369 {
00370   <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *subtree, *sub2;
00371   <font class="keywordtype">int</font> res, i;
00372   <font class="keyword">struct </font><a class="code" href="structregister__parameters.html">register_parameters</a> reg_parms;
00373   
00374   <a class="code" href="structsubtree.html">subtree</a> = (<font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *) malloc(sizeof(struct subtree));
00375   <font class="keywordflow">if</font> (<a class="code" href="structsubtree.html">subtree</a> == NULL) {
00376     <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a2">MIB_REGISTRATION_FAILED</a>;
00377   }
00378   memset(<a class="code" href="structsubtree.html">subtree</a>, 0, <font class="keyword">sizeof</font>(<font class="keyword">struct</font> <a class="code" href="structsubtree.html">subtree</a>));
00379 
00380   DEBUGMSGTL((<font class="stringliteral">"register_mib"</font>, <font class="stringliteral">"registering \"%s\" at "</font>, moduleName));
00381   DEBUGMSGOID((<font class="stringliteral">"register_mib"</font>, mibloc, mibloclen));
00382   DEBUGMSG((<font class="stringliteral">"register_mib"</font>,<font class="stringliteral">"\n"</font>));
00383     
00384         <font class="comment">/*</font>
00385          * Create the new subtree node being registered
00386          */
00387   memcpy(subtree-&gt;<a class="code" href="structsubtree.html#m0">name</a>, mibloc, mibloclen*<font class="keyword">sizeof</font>(oid));
00388   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m1">namelen</a> = (u_char) mibloclen;
00389   memcpy(subtree-&gt;<a class="code" href="structsubtree.html#m2">start</a>, mibloc, mibloclen*<font class="keyword">sizeof</font>(oid));
00390   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m3">start_len</a> = (u_char) mibloclen;
00391   memcpy(subtree-&gt;<a class="code" href="structsubtree.html#m4">end</a>, mibloc, mibloclen*<font class="keyword">sizeof</font>(oid));
00392   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m4">end</a>[ mibloclen-1 ]++;        <font class="comment">/* XXX - or use 'variables' info ? */</font>
00393   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m5">end_len</a> = (u_char) mibloclen;
00394   memcpy(subtree-&gt;<a class="code" href="structsubtree.html#m9">label</a>, moduleName, strlen(moduleName)+1);
00395   <font class="keywordflow">if</font> (var) {
00396     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m6">variables</a> = (<font class="keyword">struct </font><a class="code" href="structvariable.html">variable</a> *) malloc(varsize*numvars);
00397     <font class="keywordflow">if</font> (<a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m6">variables</a> == NULL) {
00398       free(<a class="code" href="structsubtree.html">subtree</a>);
00399       <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a2">MIB_REGISTRATION_FAILED</a>;
00400     }
00401     memcpy(subtree-&gt;<a class="code" href="structsubtree.html#m6">variables</a>, var, numvars*varsize);
00402     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m7">variables_len</a> = numvars;
00403     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m8">variables_width</a> = varsize;
00404   }
00405   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m12">priority</a> = priority;
00406   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m13">timeout</a>  = timeout;
00407   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m17">range_subid</a> = range_subid;
00408   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m18">range_ubound</a> = range_ubound;
00409   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m10">session</a> = ss;
00410   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m19">reginfo</a> = reginfo;
00411   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m11">flags</a> = (u_char)flags;  <font class="comment">/* used to identify instance oids */</font>
00412   <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m20">cacheid</a> = -1;
00413   res = <a class="code" href="agent__registry_8c.html#a23">load_subtree</a>(<a class="code" href="structsubtree.html">subtree</a>, context);
00414 
00415         <font class="comment">/*</font>
00416          * If registering a range,
00417          *   use the first subtree as a template
00418          *   for the rest of the range
00419          */
00420   <font class="keywordflow">if</font> (( res == <a class="code" href="agent__registry_8h.html#a0">MIB_REGISTERED_OK</a> ) &amp;&amp; ( range_subid != 0 )) {
00421     <font class="keywordflow">for</font> ( i = mibloc[range_subid-1] +1 ; i &lt;= (int)range_ubound ; i++ ) {
00422         sub2 = (<font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *) malloc(sizeof(struct subtree));
00423 
00424         <font class="keywordflow">if</font> (sub2 == NULL) {
00425             <a class="code" href="agent__registry_8h.html#a45">unregister_mib_context</a>(mibloc, mibloclen, priority,
00426                                    range_subid, range_ubound, context);
00427             <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a2">MIB_REGISTRATION_FAILED</a>;
00428         }
00429 
00430         memcpy(sub2, <a class="code" href="structsubtree.html">subtree</a>, <font class="keyword">sizeof</font>(<font class="keyword">struct</font> <a class="code" href="structsubtree.html">subtree</a>));
00431 
00432         <font class="comment">/*  Note: have to deep-copy sub2-&gt;variables, otherwise it will</font>
00433             be free()d more than once.  This is kind of inefficient.  */
00434         
00435         <font class="keywordflow">if</font> (<a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m6">variables</a> != NULL) {
00436           sub2-&gt;<a class="code" href="structsubtree.html#m6">variables</a> = (<font class="keyword">struct </font><a class="code" href="structvariable.html">variable</a> *)malloc(varsize * numvars);
00437           <font class="keywordflow">if</font> (sub2-&gt;<a class="code" href="structsubtree.html#m6">variables</a> == NULL) {
00438             free(sub2);
00439             <a class="code" href="agent__registry_8h.html#a45">unregister_mib_context</a>(mibloc, mibloclen, priority,
00440                                    range_subid, range_ubound, context);
00441             <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a2">MIB_REGISTRATION_FAILED</a>;
00442           }
00443 
00444           memcpy(sub2-&gt;<a class="code" href="structsubtree.html#m6">variables</a>, var, numvars * varsize);
00445         }
00446         
00447         sub2-&gt;<a class="code" href="structsubtree.html#m0">name</a>[range_subid-1] = i;
00448         sub2-&gt;<a class="code" href="structsubtree.html#m2">start</a>[range_subid-1] = i;
00449         sub2-&gt;<a class="code" href="structsubtree.html#m4">end</a>[  range_subid-1] = i;         <font class="comment">/* XXX - ???? */</font>
00450         res = <a class="code" href="agent__registry_8c.html#a23">load_subtree</a>(sub2, context);
00451         <font class="keywordflow">if</font> (res != <a class="code" href="agent__registry_8h.html#a0">MIB_REGISTERED_OK</a>) {
00452             <a class="code" href="agent__registry_8h.html#a45">unregister_mib_context</a>( mibloc, mibloclen, priority,
00453                                   range_subid, range_ubound, context);
00454             <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a2">MIB_REGISTRATION_FAILED</a>;
00455         }
00456     }
00457   } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (res == <a class="code" href="agent__registry_8h.html#a1">MIB_DUPLICATE_REGISTRATION</a> ||
00458              res == <a class="code" href="agent__registry_8h.html#a2">MIB_REGISTRATION_FAILED</a>) {
00459       <a class="code" href="agent__registry_8h.html#a47">free_subtree</a>(<a class="code" href="structsubtree.html">subtree</a>);
00460   }
00461 
00462   reg_parms.<a class="code" href="structregister__parameters.html#m0">name</a> = mibloc;
00463   reg_parms.<a class="code" href="structregister__parameters.html#m1">namelen</a> = mibloclen;
00464   reg_parms.<a class="code" href="structregister__parameters.html#m2">priority</a> = priority;
00465   reg_parms.<a class="code" href="structregister__parameters.html#m3">range_subid</a>  = range_subid;
00466   reg_parms.<a class="code" href="structregister__parameters.html#m4">range_ubound</a> = range_ubound;
00467   reg_parms.<a class="code" href="structregister__parameters.html#m5">timeout</a> = timeout;
00468   reg_parms.<a class="code" href="structregister__parameters.html#m6">flags</a> = (u_char)flags;
00469 
00470   <font class="comment">/*  Should this really be called if the registration hasn't actually </font>
00471       succeeded?  */
00472 
00473   snmp_call_callbacks(SNMP_CALLBACK_APPLICATION, <a class="code" href="agent__callbacks_8h.html#a1">SNMPD_CALLBACK_REGISTER_OID</a>,
00474                       &amp;reg_parms);
00475 
00476   <font class="keywordflow">return</font> res;
00477 }
</pre></div>    </td>
  </tr>
</table>
<a name="a29" doxytag="agent_registry.c::register_mib_priority"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_mib_priority </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>moduleName</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structvariable.html">variable</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>var</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>varsize</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>numvars</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloclen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>priority</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00552">552</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00559 {
00560   <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a39">register_mib_range</a>( moduleName, var, varsize, numvars,
00561                                 mibloc, mibloclen, priority, 0, 0, NULL );
00562 }
</pre></div>    </td>
  </tr>
</table>
<a name="a28" doxytag="agent_registry.c::register_mib_range"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_mib_range </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>moduleName</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structvariable.html">variable</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>var</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>varsize</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>numvars</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloclen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>priority</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>range_subid</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid&nbsp;</td>
          <td class="mdname">&nbsp; <em>range_ubound</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct snmp_session *&nbsp;</td>
          <td class="mdname">&nbsp; <em>ss</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00535">535</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00545 {
00546   <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a40">register_mib_context</a>( moduleName, var, varsize, numvars,
00547                                 mibloc, mibloclen, priority,
00548                                 range_subid, range_ubound, ss, <font class="stringliteral">""</font>, -1, 0);
00549 }
</pre></div>    </td>
  </tr>
</table>
<a name="a27" doxytag="agent_registry.c::register_mib_reattach"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void register_mib_reattach </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00527">527</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00527                             {
00528     <a class="code" href="structsubtree__context__cache__s.html">subtree_context_cache</a> *ptr;
00529     <font class="keywordflow">for</font>(ptr = <a class="code" href="agent__registry_8c.html#a1">context_subtrees</a>; ptr; ptr = ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m2">next</a>) {
00530         <a class="code" href="agent__registry_8c.html#a26">register_mib_reattach_subtree</a>(ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m1">first_subtree</a>);
00531     }
00532 }
</pre></div>    </td>
  </tr>
</table>
<a name="a26" doxytag="agent_registry.c::register_mib_reattach_subtree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void register_mib_reattach_subtree </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>it</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00502">502</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.
<p>
Referenced by <a class="el" href="agent__registry_8c-source.html#l00527">register_mib_reattach</a>().
<p>
<div class="fragment"><pre>00502                                                   {
00503   <font class="keyword">struct </font><a class="code" href="structregister__parameters.html">register_parameters</a> reg_parms;
00504 
00505   <font class="keywordflow">if</font> (it-&gt;<a class="code" href="structsubtree.html#m1">namelen</a> &gt; 1) {
00506       <font class="comment">/* only do registrations that are not the top level nodes */</font>
00507       <font class="comment">/* XXX: do this better */</font>
00508       reg_parms.<a class="code" href="structregister__parameters.html#m0">name</a> = it-&gt;<a class="code" href="structsubtree.html#m0">name</a>;
00509       reg_parms.<a class="code" href="structregister__parameters.html#m1">namelen</a> = it-&gt;<a class="code" href="structsubtree.html#m1">namelen</a>;
00510       reg_parms.<a class="code" href="structregister__parameters.html#m2">priority</a> = it-&gt;<a class="code" href="structsubtree.html#m12">priority</a>;
00511       reg_parms.<a class="code" href="structregister__parameters.html#m3">range_subid</a>  = it-&gt;<a class="code" href="structsubtree.html#m17">range_subid</a>;
00512       reg_parms.<a class="code" href="structregister__parameters.html#m4">range_ubound</a> = it-&gt;<a class="code" href="structsubtree.html#m18">range_ubound</a>;
00513       reg_parms.<a class="code" href="structregister__parameters.html#m5">timeout</a> = it-&gt;<a class="code" href="structsubtree.html#m13">timeout</a>;
00514       reg_parms.<a class="code" href="structregister__parameters.html#m6">flags</a> = it-&gt;<a class="code" href="structsubtree.html#m11">flags</a>;
00515       snmp_call_callbacks(SNMP_CALLBACK_APPLICATION, <a class="code" href="agent__callbacks_8h.html#a1">SNMPD_CALLBACK_REGISTER_OID</a>,
00516                           &amp;reg_parms);
00517   }
00518   
00519   <font class="keywordflow">if</font> (it-&gt;<a class="code" href="structsubtree.html#m16">children</a>)
00520       <a class="code" href="agent__registry_8c.html#a26">register_mib_reattach_subtree</a>(it-&gt;<a class="code" href="structsubtree.html#m16">children</a>);
00521   <font class="keywordflow">if</font> (it-&gt;<a class="code" href="structsubtree.html#m14">next</a>)
00522       <a class="code" href="agent__registry_8c.html#a26">register_mib_reattach_subtree</a>(it-&gt;<a class="code" href="structsubtree.html#m14">next</a>);
00523 }
</pre></div>    </td>
  </tr>
</table>
<a name="a31" doxytag="agent_registry.c::register_mib_table_row"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_mib_table_row </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>moduleName</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structvariable.html">variable</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>var</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>varsize</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>numvars</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloc</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>mibloclen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>priority</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>var_subid</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct snmp_session *&nbsp;</td>
          <td class="mdname">&nbsp; <em>ss</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>context</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>timeout</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00578">578</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00590 {
00591   <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *subtree;
00592   <font class="keyword">struct </font><a class="code" href="structregister__parameters.html">register_parameters</a> reg_parms;
00593   <font class="keywordtype">int</font> rc, x;
00594   u_char *v;
00595 
00596   <font class="keywordflow">for</font>(x = 0; x &lt; numvars; x++) {
00597 
00598     <font class="comment">/* </font>
00599      * allocate a subtree for the mib registration
00600      */
00601     <a class="code" href="structsubtree.html">subtree</a> = (<font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *) malloc(sizeof(struct subtree));
00602     <font class="keywordflow">if</font> (<a class="code" href="structsubtree.html">subtree</a> == NULL) {
00603       <a class="code" href="agent__registry_8h.html#a45">unregister_mib_context</a>(mibloc, mibloclen, priority, 
00604                              var_subid, numvars, context);
00605       <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a2">MIB_REGISTRATION_FAILED</a>;
00606     }
00607 
00608     <font class="comment">/* </font>
00609      * fill in subtree
00610      */
00611     memcpy(subtree-&gt;<a class="code" href="structsubtree.html#m0">name</a>, mibloc, mibloclen*<font class="keyword">sizeof</font>(oid));
00612     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m0">name</a>[var_subid - 1] += x;
00613     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m1">namelen</a> = (u_char) mibloclen;
00614 
00615     memcpy(subtree-&gt;<a class="code" href="structsubtree.html#m2">start</a>, mibloc, mibloclen*<font class="keyword">sizeof</font>(oid));
00616     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m2">start</a>[var_subid - 1] += x;
00617     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m3">start_len</a> = (u_char) mibloclen;
00618 
00619     memcpy(subtree-&gt;<a class="code" href="structsubtree.html#m4">end</a>, mibloc, mibloclen*<font class="keyword">sizeof</font>(oid));
00620     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m4">end</a>[var_subid - 1] += x;
00621     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m4">end</a>[mibloclen - 1]++;
00622     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m5">end_len</a> = (u_char) mibloclen;
00623 
00624     memcpy(subtree-&gt;<a class="code" href="structsubtree.html#m9">label</a>, moduleName, strlen(moduleName)+1);
00625 
00626     <font class="keywordflow">if</font> (var) {
00627       v = (u_char *)var + (x*varsize);
00628       <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m6">variables</a> = (<font class="keyword">struct </font><a class="code" href="structvariable.html">variable</a> *) malloc(varsize);
00629       memcpy(subtree-&gt;<a class="code" href="structsubtree.html#m6">variables</a>, v, varsize);
00630       <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m7">variables_len</a> = 1;
00631       <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m8">variables_width</a> = varsize;
00632     }
00633 
00634     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m12">priority</a> = priority;
00635     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m13">timeout</a>  = timeout;
00636     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m10">session</a> = ss;
00637     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m11">flags</a> = (u_char)flags;
00638     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m20">cacheid</a> = -1;
00639 
00640     <font class="comment">/*  Since we're not really making use of this in the normal way:  */</font>
00641 
00642     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m17">range_subid</a> = 0;
00643     <a class="code" href="structsubtree.html">subtree</a>-&gt;<a class="code" href="structsubtree.html#m18">range_ubound</a> = 0;
00644 
00645     <font class="comment">/*</font>
00646      * load the subtree
00647      */
00648     rc = <a class="code" href="agent__registry_8c.html#a23">load_subtree</a>(<a class="code" href="structsubtree.html">subtree</a>, context);
00649     <font class="keywordflow">if</font> ((rc != <a class="code" href="agent__registry_8h.html#a0">MIB_REGISTERED_OK</a>)) {
00650       <a class="code" href="agent__registry_8h.html#a45">unregister_mib_context</a>(mibloc, mibloclen, priority, 
00651                              var_subid, numvars, context);
00652       <font class="keywordflow">return</font> rc;
00653     }
00654   }
00655 
00656   <font class="comment">/*</font>
00657    * fill out registration parameters
00658    */
00659   reg_parms.<a class="code" href="structregister__parameters.html#m0">name</a> = mibloc;
00660   reg_parms.<a class="code" href="structregister__parameters.html#m1">namelen</a> = mibloclen;
00661   reg_parms.<a class="code" href="structregister__parameters.html#m2">priority</a> = priority;
00662   reg_parms.<a class="code" href="structregister__parameters.html#m6">flags</a> = (u_char)flags;
00663   reg_parms.<a class="code" href="structregister__parameters.html#m3">range_subid</a>  = var_subid;
00664   reg_parms.<a class="code" href="structregister__parameters.html#m4">range_ubound</a> = (mibloc[var_subid-1] + numvars - 1);
00665   reg_parms.<a class="code" href="structregister__parameters.html#m5">timeout</a> = timeout;
00666   rc = snmp_call_callbacks(SNMP_CALLBACK_APPLICATION, 1, &amp;reg_parms);
00667   <font class="keywordflow">return</font> rc;
00668 }
</pre></div>    </td>
  </tr>
</table>
<a name="a49" doxytag="agent_registry.c::register_readfd"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_readfd </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>fd</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void(*&nbsp;</td>
          <td class="mdname">&nbsp; <em>func</em>)(int, void *), </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname">&nbsp; <em>data</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01069">1069</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>01069                                                                    {
01070     <font class="keywordflow">if</font> (external_readfdlen &lt; <a class="code" href="agent__registry_8h.html#a8">NUM_EXTERNAL_FDS</a>) {
01071         external_readfd[external_readfdlen] = fd;
01072         external_readfdfunc[external_readfdlen] = func;
01073         external_readfd_data[external_readfdlen] = data;
01074         external_readfdlen++;
01075         DEBUGMSGTL((<font class="stringliteral">"register_readfd"</font>, <font class="stringliteral">"registered fd %d\n"</font>, fd));
01076         <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a9">FD_REGISTERED_OK</a>;
01077     } <font class="keywordflow">else</font> {
01078         snmp_log(LOG_CRIT, <font class="stringliteral">"register_readfd: too many file descriptors\n"</font>);
01079         <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a10">FD_REGISTRATION_FAILED</a>;
01080     }
01081 }
</pre></div>    </td>
  </tr>
</table>
<a name="a56" doxytag="agent_registry.c::register_signal"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_signal </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>sig</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void(*&nbsp;</td>
          <td class="mdname">&nbsp; <em>func</em>)(int)</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01184">1184</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>01185 {
01186 
01187     <font class="keywordflow">switch</font> (sig) {
01188 <font class="preprocessor">#if defined(SIGCHLD)</font>
01189     <font class="keywordflow">case</font> SIGCHLD:
01190 <font class="preprocessor">#ifdef HAVE_SIGACTION</font>
01191         {
01192                 <font class="keyword">static</font> <font class="keyword">struct </font>sigaction act;
01193                 act.sa_handler = <a class="code" href="agent__registry_8c.html#a55">agent_SIGCHLD_handler</a>;
01194                 sigemptyset(&amp;act.sa_mask);
01195                 act.sa_flags = 0;
01196                 sigaction(SIGCHLD, &amp;act, NULL);
01197         }
01198 <font class="preprocessor">#else</font>
01199         signal(SIGCHLD, <a class="code" href="agent__registry_8c.html#a55">agent_SIGCHLD_handler</a>);
01200 <font class="preprocessor">#endif</font>
01201         <font class="keywordflow">break</font>;
01202 <font class="preprocessor">#endif</font>
01203     <font class="keywordflow">default</font>:
01204         snmp_log(LOG_CRIT,
01205                  <font class="stringliteral">"register_signal: signal %d cannot be handled\n"</font>, sig);
01206         <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a14">SIG_REGISTRATION_FAILED</a>;
01207     }
01208 
01209     external_signal_handler[sig] = func;
01210     external_signal_scheduled[sig] = 0;
01211     
01212     DEBUGMSGTL((<font class="stringliteral">"register_signal"</font>, <font class="stringliteral">"registered signal %d\n"</font>, sig));
01213     <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a13">SIG_REGISTERED_OK</a>;
01214 }
</pre></div>    </td>
  </tr>
</table>
<a name="a50" doxytag="agent_registry.c::register_writefd"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_writefd </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>fd</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void(*&nbsp;</td>
          <td class="mdname">&nbsp; <em>func</em>)(int, void *), </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname">&nbsp; <em>data</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01083">1083</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>01083                                                                     {
01084     <font class="keywordflow">if</font> (external_writefdlen &lt; <a class="code" href="agent__registry_8h.html#a8">NUM_EXTERNAL_FDS</a>) {
01085         external_writefd[external_writefdlen] = fd;
01086         external_writefdfunc[external_writefdlen] = func;
01087         external_writefd_data[external_writefdlen] = data;
01088         external_writefdlen++;
01089         DEBUGMSGTL((<font class="stringliteral">"register_writefd"</font>, <font class="stringliteral">"registered fd %d\n"</font>, fd));
01090         <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a9">FD_REGISTERED_OK</a>;
01091     } <font class="keywordflow">else</font> {
01092         snmp_log(LOG_CRIT, <font class="stringliteral">"register_writefd: too many file descriptors\n"</font>);
01093         <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a10">FD_REGISTRATION_FAILED</a>;
01094     }
01095 }
</pre></div>    </td>
  </tr>
</table>
<a name="a20" doxytag="agent_registry.c::replace_first_subtree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structsubtree.html">subtree</a>* replace_first_subtree </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>new_tree</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>context_name</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00107">107</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.
<p>
Referenced by <a class="el" href="agent__registry_8c-source.html#l00203">load_subtree</a>().
<p>
<div class="fragment"><pre>00107                                                                           {
00108     <a class="code" href="structsubtree__context__cache__s.html">subtree_context_cache</a> *ptr;
00109     <font class="keywordflow">if</font> (!context_name)
00110         context_name = <font class="stringliteral">""</font>;
00111     <font class="keywordflow">for</font>(ptr = <a class="code" href="agent__registry_8c.html#a1">context_subtrees</a>; ptr; ptr = ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m2">next</a>) {
00112         <font class="keywordflow">if</font> (strcmp(ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m0">context_name</a>, context_name) == 0)<font class="keyword"> </font>{
00113             ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m1">first_subtree</a> = new_tree;
00114             <font class="keywordflow">return</font> ptr-&gt;<a class="code" href="structsubtree__context__cache__s.html#m1">first_subtree</a>;
00115         }
00116     }
00117     <font class="keywordflow">return</font> <a class="code" href="agent__registry_8c.html#a19">add_subtree</a>(new_tree, context_name);
00118 }
</pre></div>    </td>
  </tr>
</table>
<a name="a46" doxytag="agent_registry.c::setup_tree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void setup_tree </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01006">1006</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.
<p>
Referenced by <a class="el" href="snmp__vars_8c-source.html#l00217">init_agent</a>().
<p>
<div class="fragment"><pre>01007 {
01008 <font class="preprocessor">#ifdef USING_AGENTX_SUBAGENT_MODULE</font>
01009   <font class="keywordtype">int</font> role;
01010 
01011   role = ds_get_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a1">DS_AGENT_ROLE</a>);
01012   ds_set_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a1">DS_AGENT_ROLE</a>, <a class="code" href="snmpd_8h.html#a0">MASTER_AGENT</a>);
01013 <font class="preprocessor">#endif</font>
01014 
01015   <a class="code" href="null_8h.html#a1">register_null</a>(root_subtrees[0].name,  root_subtrees[0].namelen);
01016   <a class="code" href="null_8h.html#a1">register_null</a>(root_subtrees[1].name,  root_subtrees[1].namelen);
01017   <a class="code" href="null_8h.html#a1">register_null</a>(root_subtrees[2].name,  root_subtrees[2].namelen);
01018   
01019   <font class="comment">/* Support for 'static' subtrees (subtrees_old) has now been dropped */</font>
01020 
01021   <font class="comment">/* No longer necessary to sort the mib tree - this is inherent in</font>
01022      the construction of the subtree structure */
01023 
01024 <font class="preprocessor">#ifdef USING_AGENTX_SUBAGENT_MODULE</font>
01025   ds_set_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a1">DS_AGENT_ROLE</a>, role);
01026 <font class="preprocessor">#endif</font>
01027 }
</pre></div>    </td>
  </tr>
</table>
<a name="a22" doxytag="agent_registry.c::split_subtree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structsubtree.html">subtree</a>* split_subtree </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>current</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid&nbsp;</td>
          <td class="mdname">&nbsp; <em>name</em>[], </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>name_len</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00134">134</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.
<p>
Referenced by <a class="el" href="agent__registry_8c-source.html#l00203">load_subtree</a>().
<p>
<div class="fragment"><pre>00135 {
00136     <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *new_sub, *ptr;
00137     <font class="keywordtype">int</font> i;
00138     <font class="keywordtype">char</font> *cp;
00139 
00140     <font class="keywordflow">if</font> ( snmp_oid_compare(name, name_len,
00141                           current-&gt;<a class="code" href="structsubtree.html#m4">end</a>, current-&gt;<a class="code" href="structsubtree.html#m5">end_len</a>) &gt; 0 )
00142         <font class="keywordflow">return</font> NULL;    <font class="comment">/* Split comes after the end of this subtree */</font>
00143 
00144     new_sub = (<font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *)malloc(sizeof(struct subtree));
00145     <font class="keywordflow">if</font> ( new_sub == NULL )
00146         <font class="keywordflow">return</font> NULL;
00147     memcpy(new_sub, current, <font class="keyword">sizeof</font>(<font class="keyword">struct</font> <a class="code" href="structsubtree.html">subtree</a>));
00148 
00149         <font class="comment">/* Set up the point of division */</font>
00150     memcpy(current-&gt;<a class="code" href="structsubtree.html#m4">end</a>,   name, name_len*<font class="keyword">sizeof</font>(oid));
00151     memcpy(new_sub-&gt;<a class="code" href="structsubtree.html#m2">start</a>, name, name_len*<font class="keyword">sizeof</font>(oid));
00152     current-&gt;<a class="code" href="structsubtree.html#m5">end_len</a>   = name_len;
00153     new_sub-&gt;<a class="code" href="structsubtree.html#m3">start_len</a> = name_len;
00154 
00155         <font class="comment">/*</font>
00156          * Split the variables between the two new subtrees
00157          */
00158     i = current-&gt;<a class="code" href="structsubtree.html#m7">variables_len</a>;
00159     current-&gt;<a class="code" href="structsubtree.html#m7">variables_len</a> = 0;
00160 
00161     <font class="keywordflow">for</font> ( ; i &gt; 0 ; i-- ) {
00162                 <font class="comment">/* Note that the variable "name" field omits</font>
00163                    the prefix common to the whole registration,
00164                    hence the strange comparison here */
00165         <font class="keywordflow">if</font> ( snmp_oid_compare( new_sub-&gt;<a class="code" href="structsubtree.html#m6">variables</a>[0].name,
00166                                new_sub-&gt;<a class="code" href="structsubtree.html#m6">variables</a>[0].namelen,
00167                                name     + current-&gt;<a class="code" href="structsubtree.html#m1">namelen</a>, 
00168                                name_len - current-&gt;<a class="code" href="structsubtree.html#m1">namelen</a> ) &gt;= 0 )
00169             <font class="keywordflow">break</font>;      <font class="comment">/* All following variables belong to the second subtree */</font>
00170 
00171         current-&gt;<a class="code" href="structsubtree.html#m7">variables_len</a>++;
00172         new_sub-&gt;<a class="code" href="structsubtree.html#m7">variables_len</a>--;
00173         cp = (<font class="keywordtype">char</font> *)new_sub-&gt;<a class="code" href="structsubtree.html#m6">variables</a>;
00174         new_sub-&gt;<a class="code" href="structsubtree.html#m6">variables</a> = (<font class="keyword">struct </font><a class="code" href="structvariable.html">variable</a> *)(cp + new_sub-&gt;variables_width);
00175     }
00176 
00177         <font class="comment">/* Delegated trees should retain their variables regardless */</font>
00178     <font class="keywordflow">if</font> ( current-&gt;<a class="code" href="structsubtree.html#m7">variables_len</a> &gt; 0 &amp;&amp;
00179                 IS_DELEGATED((u_char)current-&gt;<a class="code" href="structsubtree.html#m6">variables</a>[0].type))<font class="keyword"> </font>{
00180         new_sub-&gt;variables_len = 1;
00181         new_sub-&gt;variables     = current-&gt;<a class="code" href="structsubtree.html#m6">variables</a>;
00182     }
00183 
00184         <font class="comment">/* Propogate this split down through any children */</font>
00185     <font class="keywordflow">if</font> ( current-&gt;<a class="code" href="structsubtree.html#m16">children</a> )
00186         new_sub-&gt;children = <a class="code" href="agent__registry_8c.html#a22">split_subtree</a>(current-&gt;<a class="code" href="structsubtree.html#m16">children</a>, name, name_len);
00187 
00188         <font class="comment">/* Retain the correct linking of the list */</font>
00189     <font class="keywordflow">for</font> ( ptr = current ; ptr != NULL ; ptr=ptr-&gt;<a class="code" href="structsubtree.html#m16">children</a> )
00190           ptr-&gt;<a class="code" href="structsubtree.html#m14">next</a> = new_sub;
00191     <font class="keywordflow">for</font> ( ptr = new_sub ; ptr != NULL ; ptr=ptr-&gt;<a class="code" href="structsubtree.html#m16">children</a> )
00192           ptr-&gt;<a class="code" href="structsubtree.html#m15">prev</a> = current;
00193     <font class="keywordflow">for</font> ( ptr = new_sub-&gt;next ; ptr != NULL ; ptr=ptr-&gt;<a class="code" href="structsubtree.html#m16">children</a> )
00194           ptr-&gt;<a class="code" href="structsubtree.html#m15">prev</a> = new_sub;
00195 
00196     <font class="comment">/* retain original APIv2 registration information */</font>
00197     new_sub-&gt;reginfo = current-&gt;<a class="code" href="structsubtree.html#m19">reginfo</a>;
00198 
00199     <font class="keywordflow">return</font> new_sub;
00200 }
</pre></div>    </td>
  </tr>
</table>
<a name="a21" doxytag="agent_registry.c::tree_compare"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int tree_compare </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>ap</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>bp</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00122">122</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00123 {
00124   <font class="keywordflow">return</font> snmp_oid_compare(ap-&gt;<a class="code" href="structsubtree.html#m0">name</a>,ap-&gt;<a class="code" href="structsubtree.html#m1">namelen</a>,bp-&gt;<a class="code" href="structsubtree.html#m0">name</a>,bp-&gt;<a class="code" href="structsubtree.html#m1">namelen</a>);
00125 }
</pre></div>    </td>
  </tr>
</table>
<a name="a32" doxytag="agent_registry.c::unload_subtree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void unload_subtree </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>sub</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct <a class="el" href="structsubtree.html">subtree</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>prev</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00671">671</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.
<p>
Referenced by <a class="el" href="agent__registry_8c-source.html#l00698">unregister_mib_context</a>(), and <a class="el" href="agent__registry_8c-source.html#l00781">unregister_mibs_by_session</a>().
<p>
<div class="fragment"><pre>00672 {
00673     <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *ptr;
00674 
00675     <font class="keywordflow">if</font> ( prev != NULL ) {       <font class="comment">/* non-leading entries are easy */</font>
00676         prev-&gt;<a class="code" href="structsubtree.html#m16">children</a> = sub-&gt;<a class="code" href="structsubtree.html#m16">children</a>;
00677         <font class="keywordflow">return</font>;
00678     }
00679                         <font class="comment">/* otherwise, we need to amend our neighbours as well */</font>
00680 
00681     <font class="keywordflow">if</font> ( sub-&gt;<a class="code" href="structsubtree.html#m16">children</a> == NULL) {       <font class="comment">/* just remove this node completely */</font>
00682         <font class="keywordflow">for</font> (ptr = sub-&gt;<a class="code" href="structsubtree.html#m15">prev</a> ; ptr ; ptr=ptr-&gt;<a class="code" href="structsubtree.html#m16">children</a> )
00683             ptr-&gt;<a class="code" href="structsubtree.html#m14">next</a> = sub-&gt;<a class="code" href="structsubtree.html#m14">next</a>;
00684         <font class="keywordflow">for</font> (ptr = sub-&gt;<a class="code" href="structsubtree.html#m14">next</a> ; ptr ; ptr=ptr-&gt;<a class="code" href="structsubtree.html#m16">children</a> )
00685             ptr-&gt;<a class="code" href="structsubtree.html#m15">prev</a> = sub-&gt;<a class="code" href="structsubtree.html#m15">prev</a>;
00686         <font class="keywordflow">return</font>;
00687     }
00688     <font class="keywordflow">else</font> {
00689         <font class="keywordflow">for</font> (ptr = sub-&gt;<a class="code" href="structsubtree.html#m15">prev</a> ; ptr ; ptr=ptr-&gt;<a class="code" href="structsubtree.html#m16">children</a> )
00690             ptr-&gt;<a class="code" href="structsubtree.html#m14">next</a> = sub-&gt;<a class="code" href="structsubtree.html#m16">children</a>;
00691         <font class="keywordflow">for</font> (ptr = sub-&gt;<a class="code" href="structsubtree.html#m14">next</a> ; ptr ; ptr=ptr-&gt;<a class="code" href="structsubtree.html#m16">children</a> )
00692             ptr-&gt;<a class="code" href="structsubtree.html#m15">prev</a> = sub-&gt;<a class="code" href="structsubtree.html#m16">children</a>;
00693         <font class="keywordflow">return</font>;
00694     }
00695 }
</pre></div>    </td>
  </tr>
</table>
<a name="a54" doxytag="agent_registry.c::unregister_exceptfd"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int unregister_exceptfd </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname1">&nbsp; <em>fd</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01145">1145</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>01145                                 {
01146     <font class="keywordtype">int</font> i, j;
01147 
01148     <font class="keywordflow">for</font> (i = 0; i &lt; external_exceptfdlen; i++) {
01149         <font class="keywordflow">if</font> (external_exceptfd[i] == fd) {
01150             external_exceptfdlen--;
01151             <font class="keywordflow">for</font> (j = i; j &lt; external_exceptfdlen; j++) {
01152                 external_exceptfd[j] = external_exceptfd[j+1];
01153                 external_exceptfd_data[j] = external_exceptfd_data[j+1];
01154             }
01155             DEBUGMSGTL((<font class="stringliteral">"unregister_exceptfd"</font>, <font class="stringliteral">"unregistered fd %d\n"</font>, fd));
01156             <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a11">FD_UNREGISTERED_OK</a>;
01157         }
01158     }
01159     <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a12">FD_NO_SUCH_REGISTRATION</a>;
01160 }
</pre></div>    </td>
  </tr>
</table>
<a name="a36" doxytag="agent_registry.c::unregister_mib"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int unregister_mib </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>len</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00774">774</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00776 {
00777   <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a43">unregister_mib_priority</a>( name, len, <a class="code" href="agent__registry_8h.html#a6">DEFAULT_MIB_PRIORITY</a> );
00778 }
</pre></div>    </td>
  </tr>
</table>
<a name="a33" doxytag="agent_registry.c::unregister_mib_context"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int unregister_mib_context </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>len</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>priority</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>range_subid</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid&nbsp;</td>
          <td class="mdname">&nbsp; <em>range_ubound</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>context</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00698">698</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00700 {
00701   <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *list, *myptr;
00702   <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *prev, *child;             <font class="comment">/* loop through children */</font>
00703   <font class="keyword">struct </font><a class="code" href="structregister__parameters.html">register_parameters</a> reg_parms;
00704 
00705   list = <a class="code" href="agent__registry_8h.html#a33">find_subtree</a>( name, len, <a class="code" href="agent__registry_8h.html#a60">find_first_subtree</a>(context), context );
00706   <font class="keywordflow">if</font> ( list == NULL )
00707         <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a4">MIB_NO_SUCH_REGISTRATION</a>;
00708 
00709   <font class="keywordflow">for</font> ( child=list, prev=NULL;  child != NULL;
00710                                 prev=child, child=child-&gt;<a class="code" href="structsubtree.html#m16">children</a> ) {
00711       <font class="keywordflow">if</font> (( snmp_oid_compare( child-&gt;<a class="code" href="structsubtree.html#m0">name</a>, child-&gt;<a class="code" href="structsubtree.html#m1">namelen</a>, name, len) == 0 )
00712           &amp;&amp; ( child-&gt;<a class="code" href="structsubtree.html#m12">priority</a> == priority ))
00713                 <font class="keywordflow">break</font>;  <font class="comment">/* found it */</font>
00714   }
00715   <font class="keywordflow">if</font> ( child == NULL )
00716         <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a4">MIB_NO_SUCH_REGISTRATION</a>;
00717 
00718   <a class="code" href="agent__registry_8c.html#a32">unload_subtree</a>( child, prev );
00719   myptr = child;        <font class="comment">/* remember this for later */</font>
00720 
00721                 <font class="comment">/*</font>
00722                  *  Now handle any occurances in the following subtrees,
00723                  *      as a result of splitting this range.  Due to the
00724                  *      nature of the way such splits work, the first
00725                  *      subtree 'slice' that doesn't refer to the given
00726                  *      name marks the end of the original region.
00727                  *
00728                  *  This should also serve to register ranges.
00729                  */
00730 
00731   <font class="keywordflow">for</font> ( list = myptr-&gt;<a class="code" href="structsubtree.html#m14">next</a> ; list != NULL ; list=list-&gt;<a class="code" href="structsubtree.html#m14">next</a> ) {
00732         <font class="keywordflow">for</font> ( child=list, prev=NULL;  child != NULL;
00733                                       prev=child, child=child-&gt;<a class="code" href="structsubtree.html#m16">children</a> ) {
00734             <font class="keywordflow">if</font> (( snmp_oid_compare( child-&gt;<a class="code" href="structsubtree.html#m0">name</a>, child-&gt;<a class="code" href="structsubtree.html#m1">namelen</a>,
00735                                                         name, len) == 0 )
00736                 &amp;&amp; ( child-&gt;<a class="code" href="structsubtree.html#m12">priority</a> == priority )) {
00737 
00738                     <a class="code" href="agent__registry_8c.html#a32">unload_subtree</a>( child, prev );
00739                     <a class="code" href="agent__registry_8h.html#a47">free_subtree</a>( child );
00740                     <font class="keywordflow">break</font>;
00741             }
00742         }
00743         <font class="keywordflow">if</font> ( child == NULL )    <font class="comment">/* Didn't find the given name */</font>
00744             <font class="keywordflow">break</font>;
00745   }
00746   <a class="code" href="agent__registry_8h.html#a47">free_subtree</a>( myptr );
00747   
00748   reg_parms.<a class="code" href="structregister__parameters.html#m0">name</a> = name;
00749   reg_parms.<a class="code" href="structregister__parameters.html#m1">namelen</a> = len;
00750   reg_parms.<a class="code" href="structregister__parameters.html#m2">priority</a> = priority;
00751   reg_parms.<a class="code" href="structregister__parameters.html#m3">range_subid</a>  = range_subid;
00752   reg_parms.<a class="code" href="structregister__parameters.html#m4">range_ubound</a> = range_ubound;
00753   reg_parms.<a class="code" href="structregister__parameters.html#m6">flags</a> = 0x00;  <font class="comment">/*  this is okay I think  */</font>
00754   snmp_call_callbacks(SNMP_CALLBACK_APPLICATION, <a class="code" href="agent__callbacks_8h.html#a2">SNMPD_CALLBACK_UNREGISTER_OID</a>,
00755                       &amp;reg_parms);
00756 
00757   <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a3">MIB_UNREGISTERED_OK</a>;
00758 }
</pre></div>    </td>
  </tr>
</table>
<a name="a35" doxytag="agent_registry.c::unregister_mib_priority"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int unregister_mib_priority </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>len</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>priority</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00768">768</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00769 {
00770   <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a44">unregister_mib_range</a>( name, len, priority, 0, 0 );
00771 }
</pre></div>    </td>
  </tr>
</table>
<a name="a34" doxytag="agent_registry.c::unregister_mib_range"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int unregister_mib_range </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>oid *&nbsp;</td>
          <td class="mdname">&nbsp; <em>name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>len</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>priority</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>range_subid</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>oid&nbsp;</td>
          <td class="mdname">&nbsp; <em>range_ubound</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00761">761</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00763 {
00764   <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a45">unregister_mib_context</a>( name, len, priority, range_subid, range_ubound, <font class="stringliteral">""</font> );
00765 }
</pre></div>    </td>
  </tr>
</table>
<a name="a37" doxytag="agent_registry.c::unregister_mibs_by_session"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void unregister_mibs_by_session </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct snmp_session *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>ss</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00781">781</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>00782 {
00783   <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *list, *list2;
00784   <font class="keyword">struct </font><a class="code" href="structsubtree.html">subtree</a> *child, *prev, *next_child;
00785 
00786   <font class="keywordflow">for</font>( list = (<a class="code" href="agent__registry_8h.html#a60">find_first_subtree</a>(ss-&gt;contextName)); list != NULL;
00787        list = list2) {
00788     list2 = list-&gt;<a class="code" href="structsubtree.html#m14">next</a>;
00789     <font class="keywordflow">for</font> ( child=list, prev=NULL;  child != NULL; child=next_child ) {
00790 
00791       next_child = child-&gt;<a class="code" href="structsubtree.html#m16">children</a>;
00792       <font class="keywordflow">if</font> (( (ss-&gt;flags &amp; SNMP_FLAGS_SUBSESSION) &amp;&amp; child-&gt;<a class="code" href="structsubtree.html#m10">session</a> == ss ) ||
00793           (!(ss-&gt;flags &amp; SNMP_FLAGS_SUBSESSION) &amp;&amp; child-&gt;<a class="code" href="structsubtree.html#m10">session</a> &amp;&amp;
00794                                       child-&gt;<a class="code" href="structsubtree.html#m10">session</a>-&gt;subsession == ss )) {
00795               <a class="code" href="agent__registry_8c.html#a32">unload_subtree</a>( child, prev );
00796               <a class="code" href="agent__registry_8h.html#a47">free_subtree</a>( child );
00797       }
00798       <font class="keywordflow">else</font>
00799           prev = child;
00800     }
00801   }
00802 }
</pre></div>    </td>
  </tr>
</table>
<a name="a52" doxytag="agent_registry.c::unregister_readfd"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int unregister_readfd </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname1">&nbsp; <em>fd</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01111">1111</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>01111                               {
01112     <font class="keywordtype">int</font> i, j;
01113 
01114     <font class="keywordflow">for</font> (i = 0; i &lt; external_readfdlen; i++) {
01115         <font class="keywordflow">if</font> (external_readfd[i] == fd) {
01116             external_readfdlen--;
01117             <font class="keywordflow">for</font> (j = i; j &lt; external_readfdlen; j++) {
01118                 external_readfd[j] = external_readfd[j+1];
01119                 external_readfd_data[j] = external_readfd_data[j+1];
01120             }
01121             DEBUGMSGTL((<font class="stringliteral">"unregister_readfd"</font>, <font class="stringliteral">"unregistered fd %d\n"</font>, fd));
01122             <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a11">FD_UNREGISTERED_OK</a>;
01123         }
01124     }
01125     <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a12">FD_NO_SUCH_REGISTRATION</a>;
01126 }
</pre></div>    </td>
  </tr>
</table>
<a name="a57" doxytag="agent_registry.c::unregister_signal"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int unregister_signal </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname1">&nbsp; <em>sig</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01216">1216</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>01216                                {
01217     signal(sig, SIG_DFL);
01218     DEBUGMSGTL((<font class="stringliteral">"unregister_signal"</font>, <font class="stringliteral">"unregistered signal %d\n"</font>, sig));
01219     <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a15">SIG_UNREGISTERED_OK</a>;
01220 }
</pre></div>    </td>
  </tr>
</table>
<a name="a53" doxytag="agent_registry.c::unregister_writefd"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int unregister_writefd </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname1">&nbsp; <em>fd</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01128">1128</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.<div class="fragment"><pre>01128                                {
01129     <font class="keywordtype">int</font> i, j;
01130 
01131     <font class="keywordflow">for</font> (i = 0; i &lt; external_writefdlen; i++) {
01132         <font class="keywordflow">if</font> (external_writefd[i] == fd) {
01133             external_writefdlen--;
01134             <font class="keywordflow">for</font> (j = i; j &lt; external_writefdlen; j++) {
01135                 external_writefd[j] = external_writefd[j+1];
01136                 external_writefd_data[j] = external_writefd_data[j+1];
01137             }
01138             DEBUGMSGTL((<font class="stringliteral">"unregister_writefd"</font>, <font class="stringliteral">"unregistered fd %d\n"</font>, fd));
01139             <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a11">FD_UNREGISTERED_OK</a>;
01140         }
01141     }
01142     <font class="keywordflow">return</font> <a class="code" href="agent__registry_8h.html#a12">FD_NO_SUCH_REGISTRATION</a>;
01143 }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a name="a1" doxytag="agent_registry.c::context_subtrees"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="agent__registry_8h.html#a31">subtree_context_cache</a>* context_subtrees = NULL
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l00067">67</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a7" doxytag="agent_registry.c::external_exceptfd"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int external_exceptfd[NUM_EXTERNAL_FDS]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01061">1061</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a14" doxytag="agent_registry.c::external_exceptfd_data"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void* external_exceptfd_data[NUM_EXTERNAL_FDS]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01067">1067</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a11" doxytag="agent_registry.c::external_exceptfdfunc"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void(*  external_exceptfdfunc[NUM_EXTERNAL_FDS])(int, void *)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01064">1064</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a8" doxytag="agent_registry.c::external_exceptfdlen"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int external_exceptfdlen = 0
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01061">1061</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a3" doxytag="agent_registry.c::external_readfd"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int external_readfd[NUM_EXTERNAL_FDS]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01059">1059</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a12" doxytag="agent_registry.c::external_readfd_data"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void* external_readfd_data[NUM_EXTERNAL_FDS]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01065">1065</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a9" doxytag="agent_registry.c::external_readfdfunc"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void(*  external_readfdfunc[NUM_EXTERNAL_FDS])(int, void *)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01062">1062</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a4" doxytag="agent_registry.c::external_readfdlen"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int external_readfdlen = 0
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01059">1059</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a16" doxytag="agent_registry.c::external_signal_handler"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void(*  external_signal_handler[NUM_EXTERNAL_SIGS])(int)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01163">1163</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a15" doxytag="agent_registry.c::external_signal_scheduled"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int external_signal_scheduled[NUM_EXTERNAL_SIGS]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01162">1162</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a5" doxytag="agent_registry.c::external_writefd"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int external_writefd[NUM_EXTERNAL_FDS]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01060">1060</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a13" doxytag="agent_registry.c::external_writefd_data"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void* external_writefd_data[NUM_EXTERNAL_FDS]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01066">1066</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a10" doxytag="agent_registry.c::external_writefdfunc"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void(*  external_writefdfunc[NUM_EXTERNAL_FDS])(int, void *)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01063">1063</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<a name="a6" doxytag="agent_registry.c::external_writefdlen"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int external_writefdlen = 0
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="agent__registry_8c-source.html#l01060">1060</a> of file <a class="el" href="agent__registry_8c-source.html">agent_registry.c</a>.    </td>
  </tr>
</table>
<hr><address><small>Generated on Sat Nov 10 14:09:54 2001 for net-snmp by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.11 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
<!--#include virtual="/sfbutton.html" -->
<!--#include virtual="/sfbutton.html" -->
<!-- CONTENT END -->