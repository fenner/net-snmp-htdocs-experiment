---
section: development
---
<!-- CONTENT START -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>agent_handler.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; </center>
<hr><h1>agent_handler.h</h1><div class="fragment"><pre>00001 <font class="preprocessor">#ifndef AGENT_HANDLER_H</font>
00002 <font class="preprocessor">#define AGENT_HANDLER_H</font>
00003 
00004 <font class="preprocessor">#ifdef __cplusplus</font>
00005 <font class="keyword">extern</font> <font class="stringliteral">"C"</font> {
00006 <font class="preprocessor">#endif</font>
00007 
00008 <font class="keyword">struct </font>handler_registration_s;
00009 
00010 <font class="keyword">typedef</font> <font class="keyword">struct </font>mib_handler_s {
00011    <font class="keywordtype">char</font>   *handler_name;
00012    <font class="keywordtype">void</font>   *myvoid;       <font class="comment">/* for handler's internal use */</font>
00013 
00014    int (*access_method)(<font class="keyword">struct</font> mib_handler_s *,
00015                         <font class="keyword">struct</font> handler_registration_s *,
00016                         <font class="keyword">struct</font> agent_request_info_s   *,
00017                         <font class="keyword">struct</font> request_info_s         *);
00018 
00019    <font class="keyword">struct </font>mib_handler_s *next;
00020    <font class="keyword">struct </font>mib_handler_s *prev;
00021 } mib_handler;
00022 
00023 <font class="preprocessor">#define HANDLER_CAN_GETANDGETNEXT     0x1 </font><font class="comment">/* must be able to do both */</font>
00024 <font class="preprocessor">#define HANDLER_CAN_SET               0x2</font>
00025 <font class="preprocessor">#define HANDLER_CAN_GETBULK           0x4</font>
00026 
00027 <font class="preprocessor">#define HANDLER_CAN_RONLY   (HANDLER_CAN_GETANDGETNEXT)</font>
00028 <font class="preprocessor">#define HANDLER_CAN_RWRITE  (HANDLER_CAN_GETANDGETNEXT | HANDLER_CAN_SET)</font>
00029 <font class="preprocessor">#define HANDLER_CAN_DEFAULT HANDLER_CAN_RONLY</font>
00030 
00031 <font class="comment">/* root registration info */</font>
00032 <font class="keyword">typedef</font> <font class="keyword">struct </font>handler_registration_s {
00033 
00034    <font class="keywordtype">char</font>   *handlerName;  <font class="comment">/* for mrTable listings, and other uses */</font>
00035    <font class="keywordtype">char</font>   *contextName;  <font class="comment">/* NULL = default context */</font>
00036 
00037    <font class="comment">/* where are we registered at? */</font>
00038    oid    *rootoid;
00039    size_t  rootoid_len;
00040 
00041    <font class="comment">/* handler details */</font>
00042    mib_handler *handler;
00043    <font class="keywordtype">int</font> modes;
00044    
00045    <font class="comment">/* more optional stuff */</font>
00046    <font class="keywordtype">int</font>     priority;
00047    <font class="keywordtype">int</font>     range_subid;
00048    oid     range_ubound;
00049    <font class="keywordtype">int</font>     timeout;
00050 
00051 } handler_registration;
00052 
00053 <font class="comment">/* function handler definitions */</font>
00054 <font class="keyword">typedef</font> int (NodeHandler)(
00055     mib_handler               *handler,
00056     handler_registration      *reginfo, <font class="comment">/* pointer to registration struct */</font>
00057     agent_request_info        *reqinfo, <font class="comment">/* pointer to current transaction */</font>
00058     request_info              *requests
00059     );
00060 
00061 <font class="keyword">typedef</font> <font class="keyword">struct </font>delegated_cache_s {
00062    <font class="keywordtype">int</font>                        transaction_id;
00063    mib_handler               *handler;
00064    handler_registration      *reginfo;
00065    agent_request_info        *reqinfo;
00066    request_info              *requests;
00067    <font class="keywordtype">void</font>                      *localinfo;
00068 } delegated_cache;
00069 
00070 <font class="comment">/* handler API functions */</font>
00071 <font class="keywordtype">int</font> register_handler(handler_registration *reginfo);
00072 <font class="keywordtype">int</font> inject_handler(handler_registration *reginfo, mib_handler *handler);
00073 mib_handler *find_handler_by_name(handler_registration *reginfo, <font class="keywordtype">char</font> *name);
00074 <font class="keywordtype">void</font> *find_handler_data_by_name(handler_registration *reginfo, <font class="keywordtype">char</font> *name);
00075 <font class="keywordtype">int</font> call_handlers(handler_registration *reginfo,
00076                   agent_request_info   *reqinfo,
00077                   request_info         *requests);
00078 <font class="keywordtype">int</font> call_handler(mib_handler          *next_handler,
00079                  handler_registration *reginfo,
00080                  agent_request_info   *reqinfo,
00081                  request_info         *requests);
00082 <font class="keywordtype">int</font> call_next_handler(mib_handler          *current,
00083                       handler_registration *reginfo,
00084                       agent_request_info   *reqinfo,
00085                       request_info         *requests);
00086 mib_handler *create_handler(<font class="keyword">const</font> <font class="keywordtype">char</font> *name,
00087                             NodeHandler *handler_access_method);
00088 handler_registration *
00089 create_handler_registration(<font class="keyword">const</font> <font class="keywordtype">char</font> *name,
00090                             NodeHandler *handler_access_method,
00091                             oid *reg_oid, size_t reg_oid_len, <font class="keywordtype">int</font> modes);
00092 delegated_cache *
00093 create_delegated_cache(mib_handler               *,
00094                        handler_registration      *,
00095                        agent_request_info        *,
00096                        request_info              *,
00097                        <font class="keywordtype">void</font>                      *);
00098 <font class="keyword">inline</font> delegated_cache *handler_check_cache(delegated_cache *dcache);
00099 
00100 <font class="keyword">inline</font> <font class="keywordtype">void</font>
00101 request_add_list_data(request_info *request, data_list *node);
00102 
00103 <font class="keyword">inline</font> <font class="keywordtype">void</font> *
00104 request_get_list_data(request_info *request, <font class="keyword">const</font> <font class="keywordtype">char</font> *name);
00105 
00106 <font class="keyword">inline</font> <font class="keywordtype">void</font>
00107 free_request_data_set(request_info *request);
00108 
00109 <font class="keyword">inline</font> <font class="keywordtype">void</font>
00110 free_request_data_sets(request_info *request);
00111 
00112 <font class="preprocessor">#define REQUEST_IS_DELEGATED     1</font>
00113 <font class="preprocessor">#define REQUEST_IS_NOT_DELEGATED 0</font>
00114 <font class="keywordtype">void</font> handler_mark_requests_as_delegated(request_info *, <font class="keywordtype">int</font>);
00115 <font class="keywordtype">void</font> *handler_get_parent_data(request_info *, <font class="keyword">const</font> <font class="keywordtype">char</font> *);
00116 
00117 <font class="preprocessor">#ifdef __cplusplus</font>
00118 };
00119 <font class="preprocessor">#endif</font>
00120 
00121 <font class="preprocessor">#endif </font><font class="comment">/* AGENT_HANDLER_H */</font>
</pre></div><hr><address><small>Generated on Sat Nov 10 14:21:00 2001 for net-snmp by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.11 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
<!--#include virtual="/sfbutton.html" -->
<!--#include virtual="/sfbutton.html" -->
<!-- CONTENT END -->