---
section: development
---
<!-- CONTENT START -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>snmp_agent.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>snmp_agent.h File Reference</h1><code>#include "snmp_impl.h"</code><br>
<code>#include "tools.h"</code><br>
<code>#include "data_list.h"</code><br>

<p>
<a href="snmp__agent_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Data Structures</h2></td></tr>
<tr><td nowrap align=right valign=top>struct &nbsp;</td><td valign=bottom><a class="el" href="struct__set__info.html">_set_info</a></td></tr>
<tr><td nowrap align=right valign=top>struct &nbsp;</td><td valign=bottom><a class="el" href="structagent__request__info__s.html">agent_request_info_s</a></td></tr>
<tr><td nowrap align=right valign=top>struct &nbsp;</td><td valign=bottom><a class="el" href="structagent__snmp__session.html">agent_snmp_session</a></td></tr>
<tr><td nowrap align=right valign=top>struct &nbsp;</td><td valign=bottom><a class="el" href="structrequest__info__s.html">request_info_s</a></td></tr>
<tr><td nowrap align=right valign=top>struct &nbsp;</td><td valign=bottom><a class="el" href="structtree__cache__s.html">tree_cache_s</a></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a0">SNMP_MAX_PDU_SIZE</a>&nbsp;&nbsp;&nbsp;64000</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a1">AUTO_FREE_STATEREF</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a2">AUTO_FREE_OLDDATA</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a3">AUTO_UNDO</a>&nbsp;&nbsp;&nbsp;0x03</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a4">MODE_GET</a>&nbsp;&nbsp;&nbsp;SNMP_MSG_GET</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a5">MODE_GETNEXT</a>&nbsp;&nbsp;&nbsp;SNMP_MSG_GETNEXT</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a6">MODE_GETBULK</a>&nbsp;&nbsp;&nbsp;SNMP_MSG_GETBULK</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a7">MODE_IS_GET</a>(x)&nbsp;&nbsp;&nbsp;(x == SNMP_MSG_GET || x == SNMP_MSG_GETNEXT || x == SNMP_MSG_GETBULK)</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a8">MODE_SET_BEGIN</a>&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_BEGIN</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a9">MODE_SET_RESERVE1</a>&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_RESERVE1</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a10">MODE_SET_RESERVE2</a>&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_RESERVE2</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a11">MODE_SET_ACTION</a>&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_ACTION</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a12">MODE_SET_COMMIT</a>&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_COMMIT</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a13">MODE_SET_FREE</a>&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_FREE</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a14">MODE_SET_UNDO</a>&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_UNDO</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a15">MODE_IS_SET</a>(x)&nbsp;&nbsp;&nbsp;(!MODE_IS_GET(x))</td></tr>
<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td nowrap align=right valign=top>typedef <a class="el" href="structrequest__info__s.html">request_info_s</a>&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a18">request_info</a></td></tr>
<tr><td nowrap align=right valign=top>typedef <a class="el" href="struct__set__info.html">_set_info</a>&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a19">set_info</a></td></tr>
<tr><td nowrap align=right valign=top>typedef <a class="el" href="structtree__cache__s.html">tree_cache_s</a>&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a20">tree_cache</a></td></tr>
<tr><td nowrap align=right valign=top>typedef <a class="el" href="structagent__request__info__s.html">agent_request_info_s</a>&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a22">snmp_addrcache_initialise</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a23">snmp_addrcache_age</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a24">handle_snmp_packet</a> (int, struct snmp_session *, int, struct snmp_pdu *, void *)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>handles an incoming SNMP packet into the agent.</em> <a href="#a24">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a25">handle_next_pass</a> (struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a26">handle_var_list</a> (struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a27">handle_one_var</a> (struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *, struct variable_list *varbind_ptr)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a28">snmp_agent_parse_config</a> (char *, char *)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a29">init_agent_snmp_session</a> (struct snmp_session *, struct snmp_pdu *)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a30">free_agent_snmp_session</a> (struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a31">remove_and_free_agent_snmp_session</a> (struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *asp)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a32">getNextSessID</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a33">dump_sess_list</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a34">init_master_agent</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a35">agent_check_and_process</a> (int block)</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a36">get_current_agent_session</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a37">check_outstanding_agent_requests</a> (int status)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a38">set_mode_request_error</a> (int mode, <a class="el" href="snmp__agent_8h.html#a18">request_info</a> *request, int error_value)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a39">set_request_error</a> (<a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *reqinfo, <a class="el" href="snmp__agent_8h.html#a18">request_info</a> *request, int error_value)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a40">set_all_requests_error</a> (<a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *reqinfo, <a class="el" href="snmp__agent_8h.html#a18">request_info</a> *requests, int error_value)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a41">marker_uptime</a> (marker_t pm)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a42">timeval_uptime</a> (struct timeval *tv)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a43">get_agent_uptime</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a44">check_transaction_id</a> (int transaction_id)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Decide if the requested transaction_id is still being processed within the agent.</em> <a href="#a44">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a45">snmp_check_packet</a> (struct snmp_session *, struct _snmp_transport *, void *, int)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a46">snmp_check_parse</a> (struct snmp_session *, struct snmp_pdu *, int)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a47">register_agent_nsap</a> (struct _snmp_transport *t)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a48">deregister_agent_nsap</a> (int handle)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a49">agent_add_list_data</a> (<a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *agent, data_list *node)</td></tr>
<tr><td nowrap align=right valign=top>void *&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a50">agent_get_list_data</a> (<a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *agent, const char *name)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a51">free_agent_data_set</a> (<a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *agent)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a52">free_agent_data_sets</a> (<a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *agent)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a53">free_agent_request_info</a> (<a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *ari)</td></tr>
<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a16">log_addresses</a></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="snmp__agent_8h.html#a17">lastAddrAge</a></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a name="a2" doxytag="snmp_agent.h::AUTO_FREE_OLDDATA"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define AUTO_FREE_OLDDATA&nbsp;&nbsp;&nbsp;0x02
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00055">55</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a1" doxytag="snmp_agent.h::AUTO_FREE_STATEREF"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define AUTO_FREE_STATEREF&nbsp;&nbsp;&nbsp;0x01
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00054">54</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a3" doxytag="snmp_agent.h::AUTO_UNDO"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define AUTO_UNDO&nbsp;&nbsp;&nbsp;0x03
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00056">56</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a4" doxytag="snmp_agent.h::MODE_GET"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_GET&nbsp;&nbsp;&nbsp;SNMP_MSG_GET
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00066">66</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a6" doxytag="snmp_agent.h::MODE_GETBULK"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_GETBULK&nbsp;&nbsp;&nbsp;SNMP_MSG_GETBULK
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00068">68</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a5" doxytag="snmp_agent.h::MODE_GETNEXT"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_GETNEXT&nbsp;&nbsp;&nbsp;SNMP_MSG_GETNEXT
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00067">67</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a7" doxytag="snmp_agent.h::MODE_IS_GET"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_IS_GET</td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>x&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md">&nbsp;&nbsp;&nbsp;(x == SNMP_MSG_GET || x == SNMP_MSG_GETNEXT || x == SNMP_MSG_GETBULK)
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00069">69</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a15" doxytag="snmp_agent.h::MODE_IS_SET"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_IS_SET</td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>x&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md">&nbsp;&nbsp;&nbsp;(!MODE_IS_GET(x))
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00078">78</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.
<p>
Referenced by <a class="el" href="snmp__agent_8c-source.html#l01125">add_varbind_to_cache</a>(), <a class="el" href="snmp__agent_8c-source.html#l01242">create_subtree_cache</a>(), <a class="el" href="table__array_8c-source.html#l00583">table_array_helper_handler</a>(), <a class="el" href="table__dataset_8c-source.html#l00221">table_data_set_helper_handler</a>(), and <a class="el" href="table_8c-source.html#l00135">table_helper_handler</a>().
<p>
    </td>
  </tr>
</table>
<a name="a11" doxytag="snmp_agent.h::MODE_SET_ACTION"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_SET_ACTION&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_ACTION
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00074">74</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a8" doxytag="snmp_agent.h::MODE_SET_BEGIN"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_SET_BEGIN&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_BEGIN
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00071">71</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a12" doxytag="snmp_agent.h::MODE_SET_COMMIT"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_SET_COMMIT&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_COMMIT
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00075">75</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a13" doxytag="snmp_agent.h::MODE_SET_FREE"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_SET_FREE&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_FREE
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00076">76</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a9" doxytag="snmp_agent.h::MODE_SET_RESERVE1"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_SET_RESERVE1&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_RESERVE1
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00072">72</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a10" doxytag="snmp_agent.h::MODE_SET_RESERVE2"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_SET_RESERVE2&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_RESERVE2
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00073">73</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a14" doxytag="snmp_agent.h::MODE_SET_UNDO"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODE_SET_UNDO&nbsp;&nbsp;&nbsp;SNMP_MSG_INTERNAL_SET_UNDO
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00077">77</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a0" doxytag="snmp_agent.h::SNMP_MAX_PDU_SIZE"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SNMP_MAX_PDU_SIZE&nbsp;&nbsp;&nbsp;64000
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00018">18</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a name="a21" doxytag="snmp_agent.h::agent_request_info"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="structagent__request__info__s.html">agent_request_info_s</a>  agent_request_info
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a18" doxytag="snmp_agent.h::request_info"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="structrequest__info__s.html">request_info_s</a>  request_info
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a19" doxytag="snmp_agent.h::set_info"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="struct__set__info.html">_set_info</a>  set_info
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a20" doxytag="snmp_agent.h::tree_cache"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="structtree__cache__s.html">tree_cache_s</a>  tree_cache
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a name="a49" doxytag="snmp_agent.h::agent_add_list_data"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void agent_add_list_data </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>agent</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>data_list *&nbsp;</td>
          <td class="mdname">&nbsp; <em>node</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01939">1939</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="table__array_8c-source.html#l00532">process_set_requests</a>().
<p>
<div class="fragment"><pre>01940 {
01941   <font class="keywordflow">if</font> (ari) {
01942     <font class="keywordflow">if</font> (ari-&gt;agent_data)
01943       add_list_data(&amp;ari-&gt;agent_data, node);
01944     <font class="keywordflow">else</font>
01945       ari-&gt;agent_data = node;
01946   }
01947 }
</pre></div>    </td>
  </tr>
</table>
<a name="a35" doxytag="snmp_agent.h::agent_check_and_process"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int agent_check_and_process </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname1">&nbsp; <em>block</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l00256">256</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.<div class="fragment"><pre>00256                                    {
00257   <font class="keywordtype">int</font> numfds;
00258   fd_set fdset;
00259   <font class="keyword">struct </font>timeval timeout = { LONG_MAX, 0 }, *tvp = &amp;timeout;
00260   <font class="keywordtype">int</font> count;
00261   <font class="keywordtype">int</font> fakeblock=0;
00262   
00263   numfds = 0;
00264   <a class="code" href="snmpd_8c.html#a4">FD_ZERO</a>(&amp;fdset);
00265   snmp_select_info(&amp;numfds, &amp;fdset, tvp, &amp;fakeblock);
00266   <font class="keywordflow">if</font> (block != 0 &amp;&amp; fakeblock != 0) {
00267     <font class="comment">/*  There are no alarms registered, and the caller asked for blocking, so</font>
00268         let select() block forever.  */
00269 
00270     tvp = NULL;
00271   } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (block != 0 &amp;&amp; fakeblock == 0) {
00272     <font class="comment">/*  The caller asked for blocking, but there is an alarm due sooner than</font>
00273         LONG_MAX seconds from now, so use the modified timeout returned by
00274         snmp_select_info as the timeout for select().  */
00275 
00276   } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (block == 0) {
00277     <font class="comment">/*  The caller does not want us to block at all.  */</font>
00278 
00279     tvp-&gt;tv_sec  = 0;
00280     tvp-&gt;tv_usec = 0;
00281   }
00282 
00283   count = select(numfds, &amp;fdset, 0, 0, tvp);
00284 
00285   <font class="keywordflow">if</font> (count &gt; 0) {
00286     <font class="comment">/* packets found, process them */</font>
00287     snmp_read(&amp;fdset);
00288   } <font class="keywordflow">else</font> <font class="keywordflow">switch</font>(count) {
00289     <font class="keywordflow">case</font> 0:
00290       snmp_timeout();
00291       <font class="keywordflow">break</font>;
00292     <font class="keywordflow">case</font> -1:
00293       <font class="keywordflow">if</font> (errno != EINTR) {
00294         snmp_log_perror(<font class="stringliteral">"select"</font>);
00295       }
00296       <font class="keywordflow">return</font> -1;
00297     <font class="keywordflow">default</font>:
00298       snmp_log(LOG_ERR, <font class="stringliteral">"select returned %d\n"</font>, count);
00299       <font class="keywordflow">return</font> -1;
00300   }  <font class="comment">/* endif -- count&gt;0 */</font>
00301 
00302   <font class="comment">/*  Run requested alarms.  */</font>
00303   run_alarms();
00304 
00305   <font class="keywordflow">return</font> count;
00306 }
</pre></div>    </td>
  </tr>
</table>
<a name="a50" doxytag="snmp_agent.h::agent_get_list_data"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void* agent_get_list_data </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>agent</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>name</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01950">1950</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="table_8c-source.html#l00135">table_helper_handler</a>().
<p>
<div class="fragment"><pre>01951 {
01952   <font class="keywordflow">if</font> (ari)
01953     <font class="keywordflow">return</font> get_list_data(ari-&gt;agent_data,name);
01954   <font class="keywordflow">return</font> NULL;
01955 }
</pre></div>    </td>
  </tr>
</table>
<a name="a37" doxytag="snmp_agent.h::check_outstanding_agent_requests"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void check_outstanding_agent_requests </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname1">&nbsp; <em>status</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01455">1455</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="snmpd_8c-source.html#l00291">main</a>().
<p>
<div class="fragment"><pre>01455                                              {
01456     <font class="keyword">struct </font><a class="code" href="structagent__snmp__session.html">agent_snmp_session</a> *asp, *prev_asp = NULL, *next_asp = NULL;
01457 
01458     <font class="keywordflow">for</font>(asp = <a class="code" href="snmp__agent_8c.html#a8">agent_delegated_list</a>; asp; prev_asp = asp, asp = next_asp) {
01459         next_asp = asp-&gt;<a class="code" href="structagent__snmp__session.html#m10">next</a>; <font class="comment">/* save in case we clean up asp */</font>
01460         <font class="keywordflow">if</font> (!<a class="code" href="snmp__agent_8c.html#a34">check_for_delegated</a>(asp))<font class="keyword"> </font>{
01461 
01462             <font class="comment">/* we're done with this one, remove from queue */</font>
01463             <font class="keywordflow">if</font> (prev_asp != NULL)
01464                 prev_asp-&gt;<a class="code" href="structagent__snmp__session.html#m10">next</a> = asp-&gt;<a class="code" href="structagent__snmp__session.html#m10">next</a>;
01465             <font class="keywordflow">else</font>
01466                 <a class="code" href="snmp__agent_8c.html#a8">agent_delegated_list</a> = asp-&gt;<a class="code" href="structagent__snmp__session.html#m10">next</a>;
01467 
01468             <font class="comment">/* continue processing or finish up */</font>
01469             <a class="code" href="snmp__agent_8c.html#a19">check_delayed_request</a>(asp);
01470         }
01471     }
01472 }
</pre></div>    </td>
  </tr>
</table>
<a name="a44" doxytag="snmp_agent.h::check_transaction_id"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int check_transaction_id </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname1">&nbsp; <em>transaction_id</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Decide if the requested transaction_id is still being processed within the agent.
<p>
This is used to validate whether a delayed cache (containing possibly freed pointers) is still usable.
<p>
returns SNMPERR_SUCCESS if it's still valid, or SNMPERR_GENERR if not. 
<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01480">1480</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="agent__handler_8c-source.html#l00244">handler_check_cache</a>().
<p>
<div class="fragment"><pre>01481 {
01482     <font class="keyword">struct </font><a class="code" href="structagent__snmp__session.html">agent_snmp_session</a> *asp, *prev_asp = NULL;
01483 
01484     <font class="keywordflow">for</font>(asp = <a class="code" href="snmp__agent_8c.html#a8">agent_delegated_list</a>; asp; prev_asp = asp, asp = asp-&gt;<a class="code" href="structagent__snmp__session.html#m10">next</a>) {
01485         <font class="keywordflow">if</font> (asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>-&gt;transid == transaction_id)
01486             <font class="keywordflow">return</font> SNMPERR_SUCCESS;
01487     }
01488     <font class="keywordflow">return</font> SNMPERR_GENERR;
01489 }
</pre></div>    </td>
  </tr>
</table>
<a name="a48" doxytag="snmp_agent.h::deregister_agent_nsap"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void deregister_agent_nsap </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname1">&nbsp; <em>handle</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l00580">580</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.<div class="fragment"><pre>00581 {
00582   <a class="code" href="struct__agent__nsap.html">agent_nsap</a> *a = NULL, **prevNext = &amp;agent_nsap_list;
00583   <font class="keywordtype">int</font> main_session_deregistered = 0;
00584 
00585   DEBUGMSGTL((<font class="stringliteral">"deregister_agent_nsap"</font>, <font class="stringliteral">"handle %d\n"</font>, handle));
00586 
00587   <font class="keywordflow">for</font> (a = agent_nsap_list; a != NULL &amp;&amp; a-&gt;<a class="code" href="struct__agent__nsap.html#m0">handle</a> &lt; handle; a = a-&gt;<a class="code" href="struct__agent__nsap.html#m3">next</a>) {
00588     prevNext = &amp;(a-&gt;<a class="code" href="struct__agent__nsap.html#m3">next</a>);
00589   }
00590 
00591   <font class="keywordflow">if</font> (a != NULL &amp;&amp; a-&gt;<a class="code" href="struct__agent__nsap.html#m0">handle</a> == handle) {
00592     *prevNext = a-&gt;<a class="code" href="struct__agent__nsap.html#m3">next</a>;
00593     <font class="keywordflow">if</font> (main_session == snmp_sess_session(a-&gt;<a class="code" href="struct__agent__nsap.html#m2">s</a>))<font class="keyword"> </font>{
00594       main_session_deregistered = 1;
00595     }
00596     snmp_close(snmp_sess_session(a-&gt;<a class="code" href="struct__agent__nsap.html#m2">s</a>));
00597     <font class="comment">/*  The above free()s the transport and session pointers.  */</font>
00598     free(a);
00599   }
00600 
00601   <font class="comment">/*  If we've deregistered the session that main_session used to point to,</font>
00602       then make it point to another one, or in the last resort, make it equal
00603       to NULL.  Basically this shouldn't ever happen in normal operation
00604       because main_session starts off pointing at the first session added by
00605       init_master_agent(), which then discards the handle.  */
00606 
00607   <font class="keywordflow">if</font> (main_session_deregistered) {
00608     <font class="keywordflow">if</font> (agent_nsap_list != NULL) {
00609       DEBUGMSGTL((<font class="stringliteral">"snmp_agent"</font>,
00610                   <font class="stringliteral">"WARNING: main_session pointer changed from %p to %p\n"</font>,
00611                   main_session, snmp_sess_session(agent_nsap_list-&gt;s)));
00612       main_session = snmp_sess_session(agent_nsap_list-&gt;s);
00613     } <font class="keywordflow">else</font> {
00614       DEBUGMSGTL((<font class="stringliteral">"snmp_agent"</font>,
00615                   <font class="stringliteral">"WARNING: main_session pointer changed from %p to NULL\n"</font>,
00616                   main_session));
00617       main_session = NULL;
00618     }
00619   }
00620 }
</pre></div>    </td>
  </tr>
</table>
<a name="a33" doxytag="snmp_agent.h::dump_sess_list"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void dump_sess_list </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l00972">972</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.<div class="fragment"><pre>00973 {
00974     <font class="keyword">struct </font><a class="code" href="structagent__snmp__session.html">agent_snmp_session</a> *a;
00975     
00976     DEBUGMSGTL((<font class="stringliteral">"snmp_agent"</font>, <font class="stringliteral">"DUMP agent_sess_list -&gt; "</font>));
00977     <font class="keywordflow">for</font> (a = agent_session_list; a != NULL; a = a-&gt;<a class="code" href="structagent__snmp__session.html#m10">next</a>) {
00978         DEBUGMSG((<font class="stringliteral">"snmp_agent"</font>, <font class="stringliteral">"%08p[session %08p] -&gt; "</font>, a, a-&gt;<a class="code" href="structagent__snmp__session.html#m3">session</a>));
00979     }
00980     DEBUGMSG((<font class="stringliteral">"snmp_agent"</font>, <font class="stringliteral">"[NIL]\n"</font>));
00981 }
</pre></div>    </td>
  </tr>
</table>
<a name="a51" doxytag="snmp_agent.h::free_agent_data_set"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void free_agent_data_set </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>agent</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01958">1958</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.<div class="fragment"><pre>01959 {
01960   <font class="keywordflow">if</font> (ari)
01961     free_list_data(ari-&gt;agent_data);
01962 }
</pre></div>    </td>
  </tr>
</table>
<a name="a52" doxytag="snmp_agent.h::free_agent_data_sets"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void free_agent_data_sets </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>agent</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01965">1965</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="table_8c-source.html#l00135">table_helper_handler</a>().
<p>
<div class="fragment"><pre>01966 {
01967   <font class="keywordflow">if</font> (ari)
01968     free_all_list_data(ari-&gt;agent_data);
01969 }
</pre></div>    </td>
  </tr>
</table>
<a name="a53" doxytag="snmp_agent.h::free_agent_request_info"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void free_agent_request_info </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>ari</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01972">1972</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="snmp__agent_8c-source.html#l00840">free_agent_snmp_session</a>().
<p>
<div class="fragment"><pre>01973 {
01974     <font class="keywordflow">if</font> (ari) {
01975         <font class="keywordflow">if</font> (ari-&gt;<a class="code" href="structagent__request__info__s.html#m3">agent_data</a>)
01976             free_all_list_data(ari-&gt;<a class="code" href="structagent__request__info__s.html#m3">agent_data</a>);
01977         free(ari);
01978     }
01979 }
</pre></div>    </td>
  </tr>
</table>
<a name="a30" doxytag="snmp_agent.h::free_agent_snmp_session"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void free_agent_snmp_session </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>asp</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l00840">840</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="snmp__agent_8c-source.html#l01009">free_agent_snmp_session_by_session</a>(), and <a class="el" href="snmp__agent_8c-source.html#l00984">remove_and_free_agent_snmp_session</a>().
<p>
<div class="fragment"><pre>00841 {
00842     <font class="keywordflow">if</font> (!asp)
00843         <font class="keywordflow">return</font>;
00844     <font class="keywordflow">if</font> (asp-&gt;<a class="code" href="structagent__snmp__session.html#m5">orig_pdu</a>)
00845         snmp_free_pdu(asp-&gt;<a class="code" href="structagent__snmp__session.html#m5">orig_pdu</a>);
00846     <font class="keywordflow">if</font> (asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>)
00847         snmp_free_pdu(asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>);
00848     <font class="keywordflow">if</font> (asp-&gt;<a class="code" href="structagent__snmp__session.html#m11">reqinfo</a>)
00849         <a class="code" href="snmp__agent_8h.html#a53">free_agent_request_info</a>(asp-&gt;<a class="code" href="structagent__snmp__session.html#m11">reqinfo</a>);
00850     <font class="keywordflow">if</font> (asp-&gt;<a class="code" href="structagent__snmp__session.html#m12">treecache</a>) {
00851         <a class="code" href="snmp__agent_8c.html#a16">delete_subtree_cache</a>(asp);
00852         free(asp-&gt;<a class="code" href="structagent__snmp__session.html#m12">treecache</a>);
00853     }
00854     free(asp);
00855 }
</pre></div>    </td>
  </tr>
</table>
<a name="a32" doxytag="snmp_agent.h::getNextSessID"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int getNextSessID </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l00248">248</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.<div class="fragment"><pre>00249 {
00250     <font class="keyword">static</font> <font class="keywordtype">int</font> SessionID = 0;
00251 
00252     <font class="keywordflow">return</font> ++SessionID;
00253 }
</pre></div>    </td>
  </tr>
</table>
<a name="a43" doxytag="snmp_agent.h::get_agent_uptime"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int get_agent_uptime </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01928">1928</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.<div class="fragment"><pre>01928                          {
01929 
01930         <font class="keyword">struct </font>timeval now;
01931         gettimeofday(&amp;now, NULL);
01932 
01933         <font class="keywordflow">return</font> <a class="code" href="snmp__agent_8h.html#a42">timeval_uptime</a>( &amp;now );
01934 }
</pre></div>    </td>
  </tr>
</table>
<a name="a36" doxytag="snmp_agent.h::get_current_agent_session"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a>* get_current_agent_session </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="old__api_8c-source.html#l00022">22</a> of file <a class="el" href="old__api_8c-source.html">old_api.c</a>.
<p>
Referenced by <a class="el" href="old__api_8c-source.html#l00097">old_api_helper</a>().
<p>
<div class="fragment"><pre>00022                             {
00023     <font class="keywordflow">return</font> current_agent_session;
00024 }
</pre></div>    </td>
  </tr>
</table>
<a name="a25" doxytag="snmp_agent.h::handle_next_pass"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int handle_next_pass </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a27" doxytag="snmp_agent.h::handle_one_var"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int handle_one_var </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *&nbsp;</td>
          <td class="mdname">&nbsp;, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct variable_list *&nbsp;</td>
          <td class="mdname">&nbsp; <em>varbind_ptr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a24" doxytag="snmp_agent.h::handle_snmp_packet"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int handle_snmp_packet </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>op</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct snmp_session *&nbsp;</td>
          <td class="mdname">&nbsp; <em>session</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>reqid</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct snmp_pdu *&nbsp;</td>
          <td class="mdname">&nbsp; <em>pdu</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname">&nbsp; <em>magic</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
handles an incoming SNMP packet into the agent.
<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01030">1030</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.<div class="fragment"><pre>01032 {
01033     <font class="keyword">struct </font><a class="code" href="structagent__snmp__session.html">agent_snmp_session</a>  *asp;
01034     <font class="keywordtype">int</font> status, access_ret;
01035     <font class="keyword">struct </font>variable_list *var_ptr;
01036 
01037     <font class="comment">/* we only support receiving here */</font>
01038     <font class="keywordflow">if</font> (op != SNMP_CALLBACK_OP_RECEIVED_MESSAGE) {
01039       <font class="keywordflow">return</font> 1;
01040     }
01041 
01042     <font class="comment">/* new request */</font>
01043     asp = <a class="code" href="snmp__agent_8h.html#a29">init_agent_snmp_session</a>( session, pdu );
01044     status = SNMP_ERR_NOERROR;
01045 
01046     <font class="comment">/* initial access check.  Is request user/community allowed to do</font>
01047        anything at all? If not, abondon all hope here. */
01048     <font class="keywordflow">if</font> ((access_ret = <a class="code" href="agent__registry_8h.html#a50">check_access</a>(pdu)) != 0) {
01049         <font class="keywordflow">if</font> (access_ret == VACM_NOSUCHCONTEXT) {
01050             <font class="comment">/* rfc2573 section 3.2, step 5 says that we increment the</font>
01051                counter but don't return a response of any kind */
01052                
01053             <font class="comment">/* we currently don't support unavailable contexts, as</font>
01054                there is no reason to that I currently know of */
01055             snmp_increment_statistic(STAT_SNMPUNKNOWNCONTEXTS);
01056 
01057             <font class="comment">/* drop the request */</font>
01058             <a class="code" href="snmp__agent_8h.html#a31">remove_and_free_agent_snmp_session</a>( asp );
01059             <font class="keywordflow">return</font> 0;
01060         } <font class="keywordflow">else</font> {
01061             <font class="comment">/* access control setup is incorrect */</font>
01062             <a class="code" href="agent__trap_8h.html#a0">send_easy_trap</a>(SNMP_TRAP_AUTHFAIL, 0);
01063             <font class="keywordflow">if</font> (asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>-&gt;version != SNMP_VERSION_1 &amp;&amp;
01064                 asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>-&gt;version != SNMP_VERSION_2c) {
01065                 asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>-&gt;errstat = SNMP_ERR_AUTHORIZATIONERROR;
01066                 asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>-&gt;command = SNMP_MSG_RESPONSE;
01067                 snmp_increment_statistic(STAT_SNMPOUTPKTS);
01068                 <font class="keywordflow">if</font> (! snmp_send( asp-&gt;<a class="code" href="structagent__snmp__session.html#m3">session</a>, asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a> ))
01069                     snmp_free_pdu(asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>);
01070                 asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a> = NULL;
01071                 <a class="code" href="snmp__agent_8h.html#a31">remove_and_free_agent_snmp_session</a>(asp);
01072                 <font class="keywordflow">return</font> 1;
01073             } <font class="keywordflow">else</font> {
01074                 <font class="comment">/* drop the request */</font>
01075                 <a class="code" href="snmp__agent_8h.html#a31">remove_and_free_agent_snmp_session</a>( asp );
01076                 <font class="keywordflow">return</font> 0;
01077             }
01078         }
01079     }
01080 
01081     <font class="comment">/* process the request */</font>
01082     status = <a class="code" href="snmp__agent_8c.html#a17">handle_pdu</a>(asp);
01083 
01084     <font class="comment">/* print the results in approrpiate debugging mode */</font>
01085     DEBUGIF(<font class="stringliteral">"results"</font>)<font class="keyword"> </font>{
01086         DEBUGMSGTL((<font class="stringliteral">"results"</font>,<font class="stringliteral">"request results (status = %d): \n"</font>, status));
01087         <font class="keywordflow">for</font>(var_ptr = asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>-&gt;variables; var_ptr;
01088             var_ptr = var_ptr-&gt;next_variable) {
01089             <font class="keywordtype">char</font> buf[SPRINT_MAX_LEN];
01090             sprint_variable(buf, var_ptr-&gt;name, var_ptr-&gt;name_length, var_ptr);
01091             DEBUGMSGTL((<font class="stringliteral">"results"</font>,<font class="stringliteral">"  %s\n"</font>, buf));
01092         }
01093     }
01094 
01095     <font class="comment">/* check for uncompleted requests */</font>
01096     <font class="keywordflow">if</font> (<a class="code" href="snmp__agent_8c.html#a34">check_for_delegated</a>(asp))<font class="keyword"> </font>{
01097         <font class="comment">/* add to delegated request chain */</font>
01098         asp-&gt;<a class="code" href="structagent__snmp__session.html#m8">status</a> = status;
01099         asp-&gt;<a class="code" href="structagent__snmp__session.html#m10">next</a> = <a class="code" href="snmp__agent_8c.html#a8">agent_delegated_list</a>;
01100         <a class="code" href="snmp__agent_8c.html#a8">agent_delegated_list</a> = asp;
01101     } <font class="keywordflow">else</font> {
01102         <font class="comment">/* if we don't have anything outstanding (delegated), wrap up */</font>
01103         <font class="keywordflow">return</font> <a class="code" href="snmp__agent_8c.html#a18">wrap_up_request</a>(asp, status);
01104     }
01105 
01106     <font class="comment">/* done */</font>
01107     DEBUGMSGTL((<font class="stringliteral">"snmp_agent"</font>, <font class="stringliteral">"end of handle_snmp_packet, asp = %08p\n"</font>, asp));
01108     <font class="keywordflow">return</font> 1;
01109 }
</pre></div>    </td>
  </tr>
</table>
<a name="a26" doxytag="snmp_agent.h::handle_var_list"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int handle_var_list </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a29" doxytag="snmp_agent.h::init_agent_snmp_session"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a>* init_agent_snmp_session </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct snmp_session *&nbsp;</td>
          <td class="mdname">&nbsp; <em>session</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct snmp_pdu *&nbsp;</td>
          <td class="mdname">&nbsp; <em>pdu</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l00812">812</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="snmp__agent_8c-source.html#l01030">handle_snmp_packet</a>().
<p>
<div class="fragment"><pre>00813 {
00814     <font class="keyword">struct </font><a class="code" href="structagent__snmp__session.html">agent_snmp_session</a>  *asp;
00815 
00816     asp = (<font class="keyword">struct </font><a class="code" href="structagent__snmp__session.html">agent_snmp_session</a> *) calloc(1, sizeof( struct agent_snmp_session ));
00817 
00818     <font class="keywordflow">if</font> ( asp == NULL )
00819         <font class="keywordflow">return</font> NULL;
00820     asp-&gt;<a class="code" href="structagent__snmp__session.html#m3">session</a> = session;
00821     asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>      = snmp_clone_pdu(pdu);
00822     asp-&gt;<a class="code" href="structagent__snmp__session.html#m5">orig_pdu</a> = snmp_clone_pdu(pdu);
00823     asp-&gt;<a class="code" href="structagent__snmp__session.html#m6">rw</a>      = READ;
00824     asp-&gt;<a class="code" href="structagent__snmp__session.html#m7">exact</a>   = TRUE;
00825     asp-&gt;<a class="code" href="structagent__snmp__session.html#m10">next</a>    = NULL;
00826     asp-&gt;<a class="code" href="structagent__snmp__session.html#m0">mode</a>    = RESERVE1;
00827     asp-&gt;<a class="code" href="structagent__snmp__session.html#m8">status</a>  = SNMP_ERR_NOERROR;
00828     asp-&gt;<a class="code" href="structagent__snmp__session.html#m9">index</a>   = 0;
00829 
00830     asp-&gt;<a class="code" href="structagent__snmp__session.html#m1">start</a> = asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>-&gt;variables;
00831     asp-&gt;<a class="code" href="structagent__snmp__session.html#m2">end</a>   = asp-&gt;<a class="code" href="structagent__snmp__session.html#m4">pdu</a>-&gt;variables;
00832     <font class="keywordflow">if</font> ( asp-&gt;<a class="code" href="structagent__snmp__session.html#m2">end</a> != NULL )
00833         <font class="keywordflow">while</font> ( asp-&gt;<a class="code" href="structagent__snmp__session.html#m2">end</a>-&gt;next_variable != NULL )
00834             asp-&gt;<a class="code" href="structagent__snmp__session.html#m2">end</a> = asp-&gt;<a class="code" href="structagent__snmp__session.html#m2">end</a>-&gt;next_variable;
00835 
00836     <font class="keywordflow">return</font> asp;
00837 }
</pre></div>    </td>
  </tr>
</table>
<a name="a34" doxytag="snmp_agent.h::init_master_agent"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int init_master_agent </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l00648">648</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.<div class="fragment"><pre>00649 {
00650   snmp_transport *transport;
00651   <font class="keywordtype">char</font> *cptr, *cptr2;
00652   <font class="keywordtype">char</font> buf[SPRINT_MAX_LEN];
00653 
00654   <font class="keywordflow">if</font> (ds_get_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a1">DS_AGENT_ROLE</a>) != <a class="code" href="snmpd_8h.html#a0">MASTER_AGENT</a>)<font class="keyword"> </font>{
00655     DEBUGMSGTL((<font class="stringliteral">"snmp_agent"</font>, <font class="stringliteral">"init_master_agent; not master agent\n"</font>));
00656     <font class="keywordflow">return</font> 0; <font class="comment">/*  No error if ! MASTER_AGENT  */</font>
00657   }
00658 
00659 <font class="preprocessor">#ifdef USING_AGENTX_MASTER_MODULE</font>
00660     <font class="keywordflow">if</font> ( ds_get_boolean(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a3">DS_AGENT_AGENTX_MASTER</a>) == 1 )
00661         real_init_master();
00662 <font class="preprocessor">#endif</font>
00663 
00664   <font class="comment">/*  Have specific agent ports been specified?  */</font>
00665   cptr = ds_get_string(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a6">DS_AGENT_PORTS</a>);
00666 
00667   <font class="keywordflow">if</font> (cptr) {
00668     sprintf(buf, <font class="stringliteral">"%s"</font>, cptr);
00669   } <font class="keywordflow">else</font> {
00670     <font class="comment">/*  No, so just specify the default port.  */</font>
00671     <font class="keywordflow">if</font> (ds_get_int(DS_APPLICATION_ID, <a class="code" href="ds__agent_8h.html#a8">DS_AGENT_FLAGS</a>) &amp;
00672         SNMP_FLAGS_STREAM_SOCKET)<font class="keyword"> </font>{
00673       sprintf(buf, <font class="stringliteral">"tcp:%d"</font>, SNMP_PORT);
00674     } <font class="keywordflow">else</font> {
00675       sprintf(buf, <font class="stringliteral">"udp:%d"</font>, SNMP_PORT);
00676     }
00677   }
00678 
00679   DEBUGMSGTL((<font class="stringliteral">"snmp_agent"</font>, <font class="stringliteral">"final port spec: %s\n"</font>, buf));
00680   cptr = strtok(buf, <font class="stringliteral">","</font>);
00681   <font class="keywordflow">while</font> (cptr) {
00682     <font class="comment">/*  Specification format: </font>
00683         
00684         NONE:                     (a pseudo-transport)
00685         UDP:[address:]port        (also default if no transport is specified)
00686         TCP:[address:]port        (if supported)
00687         Unix:pathname             (if supported)
00688         AAL5PVC:itf.vpi.vci       (if supported)
00689         IPX:[network]:node[/port] (if supported)
00690 
00691     */
00692 
00693     DEBUGMSGTL((<font class="stringliteral">"snmp_agent"</font>, <font class="stringliteral">"installing master agent on port %s\n"</font>, cptr));
00694 
00695     <font class="keywordflow">if</font> (!cptr || !(*cptr)) {
00696       snmp_log(LOG_ERR, <font class="stringliteral">"improper port specification\n"</font>);
00697       <font class="keywordflow">return</font> 1;
00698     }
00699 
00700     <font class="comment">/*  Transport type specifier?  */</font>
00701 
00702     <font class="keywordflow">if</font> ((cptr2 = strchr(cptr, <font class="charliteral">':'</font>)) != NULL) {
00703       <font class="keywordflow">if</font> (strncasecmp(cptr, <font class="stringliteral">"none"</font>, 4) == 0)<font class="keyword"> </font>{
00704         DEBUGMSGTL((<font class="stringliteral">"snmp_agent"</font>,
00705                  <font class="stringliteral">"init_master_agent; pseudo-transport \"none\" requested\n"</font>));
00706         <font class="keywordflow">return</font> 0;
00707       } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (strncasecmp(cptr, <font class="stringliteral">"tcp"</font>, 3) == 0)<font class="keyword"> </font>{
00708 <font class="preprocessor">#ifdef SNMP_TRANSPORT_TCP_DOMAIN</font>
00709         <font class="keyword">struct </font>sockaddr_in addr;
00710         <font class="keywordflow">if</font> (snmp_sockaddr_in(&amp;addr, cptr2+1, 0))<font class="keyword"> </font>{
00711           transport = snmp_tcp_transport(&amp;addr, 1);
00712         } <font class="keywordflow">else</font> {
00713           snmp_log(LOG_ERR,
00714                    <font class="stringliteral">"Badly formatted IP address (should be [a.b.c.d:]p)\n"</font>);
00715           <font class="keywordflow">return</font> 1;
00716         }
00717 <font class="preprocessor">#else</font>
00718         snmp_log(LOG_ERR, <font class="stringliteral">"No support for requested TCP domain\n"</font>);
00719         <font class="keywordflow">return</font> 1;
00720 <font class="preprocessor">#endif</font>
00721       } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (strncasecmp(cptr, <font class="stringliteral">"ipx"</font>, 3) == 0)<font class="keyword"> </font>{
00722 <font class="preprocessor">#ifdef SNMP_TRANSPORT_IPX_DOMAIN</font>
00723         <font class="keyword">struct </font>sockaddr_ipx addr;
00724         <font class="keywordflow">if</font> (snmp_sockaddr_ipx(&amp;addr, cptr2+1))<font class="keyword"> </font>{
00725           transport = snmp_ipx_transport(&amp;addr, 1);
00726         } <font class="keywordflow">else</font> {
00727           snmp_log(LOG_ERR,
00728                <font class="stringliteral">"Badly formatted IPX address (should be [net]:node[/port])\n"</font>);
00729           <font class="keywordflow">return</font> 1;
00730         }
00731 <font class="preprocessor">#else</font>
00732         snmp_log(LOG_ERR, <font class="stringliteral">"No support for requested IPX domain\n"</font>);
00733 <font class="preprocessor">#endif</font>
00734       } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (strncasecmp(cptr, <font class="stringliteral">"aal5pvc"</font>, 7) == 0)<font class="keyword"> </font>{
00735 <font class="preprocessor">#ifdef SNMP_TRANSPORT_AAL5PVC_DOMAIN</font>
00736         <font class="keyword">struct </font>sockaddr_atmpvc addr;
00737         <font class="keywordflow">if</font> (sscanf(cptr2+1, <font class="stringliteral">"%d.%d.%d"</font>, &amp;(addr.sap_addr.itf),
00738                    &amp;(addr.sap_addr.vpi), &amp;(addr.sap_addr.vci))==3)<font class="keyword"> </font>{
00739           addr.sap_family = AF_ATMPVC;
00740           transport = snmp_aal5pvc_transport(&amp;addr, 1);
00741         } <font class="keywordflow">else</font> {
00742           snmp_log(LOG_ERR,
00743                  <font class="stringliteral">"Badly formatted AAL5 PVC address (should be itf.vpi.vci)\n"</font>);
00744           <font class="keywordflow">return</font> 1;
00745         }
00746 <font class="preprocessor">#else</font>
00747         snmp_log(LOG_ERR, <font class="stringliteral">"No support for requested AAL5 PVC domain\n"</font>);
00748         <font class="keywordflow">return</font> 1;
00749 <font class="preprocessor">#endif</font>
00750       } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (strncasecmp(cptr, <font class="stringliteral">"unix"</font>, 4) == 0)<font class="keyword"> </font>{
00751 <font class="preprocessor">#ifdef SNMP_TRANSPORT_UNIX_DOMAIN</font>
00752         <font class="keyword">struct </font>sockaddr_un addr;
00753         addr.sun_family = AF_UNIX;
00754         strncpy(addr.sun_path, cptr2+1, 
00755                 <font class="keyword">sizeof</font>(addr) - (size_t) (((<font class="keyword">struct</font> sockaddr_un *)0)-&gt;sun_path));
00756         transport = snmp_unix_transport(&amp;addr, 1);
00757 <font class="preprocessor">#else</font>
00758         snmp_log(LOG_ERR, <font class="stringliteral">"No support for requested Unix domain\n"</font>);
00759         <font class="keywordflow">return</font> 1;
00760 <font class="preprocessor">#endif</font>
00761       } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (strncasecmp(cptr, <font class="stringliteral">"udp"</font>, 3) == 0)<font class="keyword"> </font>{
00762         <font class="keyword">struct </font>sockaddr_in addr;
00763         <font class="keywordflow">if</font> (snmp_sockaddr_in(&amp;addr, cptr2+1, 0))<font class="keyword"> </font>{
00764           transport = snmp_udp_transport(&amp;addr, 1);
00765         } <font class="keywordflow">else</font> {
00766           snmp_log(LOG_ERR,
00767                    <font class="stringliteral">"Badly formatted IP address (should be [a.b.c.d:]p)\n"</font>);
00768           <font class="keywordflow">return</font> 1;
00769         }
00770       } <font class="keywordflow">else</font> {
00771         snmp_log(LOG_ERR, <font class="stringliteral">"Unknown transport domain \"%s\"\n"</font>, cptr);
00772         <font class="keywordflow">return</font> 1;
00773       }
00774     } <font class="keywordflow">else</font> {
00775       <font class="comment">/*  No transport type specifier; default to UDP.  */</font>
00776       <font class="keyword">struct </font>sockaddr_in addr;
00777       <font class="keywordflow">if</font> (snmp_sockaddr_in(&amp;addr, cptr, 0))<font class="keyword"> </font>{
00778         transport = snmp_udp_transport(&amp;addr, 1);
00779       } <font class="keywordflow">else</font> {
00780         snmp_log(LOG_ERR,
00781                  <font class="stringliteral">"Badly formatted IP address (should be [a.b.c.d:]p)\n"</font>);
00782         <font class="keywordflow">return</font> 1;
00783       }
00784     }
00785 
00786     <font class="keywordflow">if</font> (transport == NULL) {
00787       snmp_log(LOG_ERR, <font class="stringliteral">"Error opening specified transport \"%s\"\n"</font>, cptr);
00788       <font class="keywordflow">return</font> 1;
00789     }
00790 
00791     <font class="keywordflow">if</font> (<a class="code" href="snmp__agent_8h.html#a47">register_agent_nsap</a>(transport) == 0)<font class="keyword"> </font>{
00792       snmp_log(LOG_ERR,
00793              <font class="stringliteral">"Error registering specified transport \"%s\" as an agent NSAP\n"</font>,
00794                cptr);
00795       <font class="keywordflow">return</font> 1;
00796     } <font class="keywordflow">else</font> {
00797       DEBUGMSGTL((<font class="stringliteral">"snmp_agent"</font>,
00798                   <font class="stringliteral">"init_master_agent; \"%s\" registered as an agent NSAP\n"</font>,
00799                   cptr));
00800     }
00801 
00802     <font class="comment">/*  Next transport please...  */</font>
00803     cptr = strtok(NULL, <font class="stringliteral">","</font>);
00804   }
00805 
00806   <font class="keywordflow">return</font> 0;
00807 }
</pre></div>    </td>
  </tr>
</table>
<a name="a41" doxytag="snmp_agent.h::marker_uptime"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int marker_uptime </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>marker_t&nbsp;</td>
          <td class="mdname1">&nbsp; <em>pm</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01911">1911</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="snmp__agent_8c-source.html#l01921">timeval_uptime</a>().
<p>
<div class="fragment"><pre>01912 {
01913     <font class="keywordtype">int</font> res;
01914     marker_t start = (marker_t)&amp;starttime;
01915 
01916     res = atime_diff( start, pm );
01917     <font class="keywordflow">return</font> res/10;      <font class="comment">/* atime_diff works in msec, not csec */</font>
01918 }
</pre></div>    </td>
  </tr>
</table>
<a name="a47" doxytag="snmp_agent.h::register_agent_nsap"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_agent_nsap </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct _snmp_transport *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>t</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="snmp__agent_8c-source.html#l00648">init_master_agent</a>().
<p>
    </td>
  </tr>
</table>
<a name="a31" doxytag="snmp_agent.h::remove_and_free_agent_snmp_session"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void remove_and_free_agent_snmp_session </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct <a class="el" href="structagent__snmp__session.html">agent_snmp_session</a> *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>asp</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l00984">984</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="snmp__agent_8c-source.html#l01030">handle_snmp_packet</a>(), and <a class="el" href="snmp__agent_8c-source.html#l00874">wrap_up_request</a>().
<p>
<div class="fragment"><pre>00985 {
00986     <font class="keyword">struct </font><a class="code" href="structagent__snmp__session.html">agent_snmp_session</a> *a, **prevNext = &amp;agent_session_list;
00987 
00988     DEBUGMSGTL((<font class="stringliteral">"snmp_agent"</font>, <font class="stringliteral">"REMOVE %08p\n"</font>, asp));
00989 
00990     <font class="keywordflow">for</font> (a = agent_session_list; a != NULL; a = *prevNext) {
00991         <font class="keywordflow">if</font> (a == asp) {
00992             *prevNext = a-&gt;<a class="code" href="structagent__snmp__session.html#m10">next</a>;
00993             a-&gt;<a class="code" href="structagent__snmp__session.html#m10">next</a> = NULL;
00994             <a class="code" href="snmp__agent_8h.html#a30">free_agent_snmp_session</a>(a);
00995             asp = NULL;
00996             <font class="keywordflow">break</font>;
00997         } <font class="keywordflow">else</font> {
00998             prevNext = &amp;(a-&gt;<a class="code" href="structagent__snmp__session.html#m10">next</a>);
00999         }
01000     }
01001 
01002     <font class="keywordflow">if</font> (a == NULL &amp;&amp; asp != NULL) {
01003         <font class="comment">/*  We coulnd't find it on the list, so free it anyway.  */</font>
01004         <a class="code" href="snmp__agent_8h.html#a30">free_agent_snmp_session</a>(asp);
01005     }
01006 }
</pre></div>    </td>
  </tr>
</table>
<a name="a40" doxytag="snmp_agent.h::set_all_requests_error"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int set_all_requests_error </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>reqinfo</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a18">request_info</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>requests</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>error_value</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01898">1898</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="multiplexer_8c-source.html#l00032">multiplexer_helper_handler</a>(), <a class="el" href="null_8c-source.html#l00030">null_handler</a>(), and <a class="el" href="read__only_8c-source.html#l00024">read_only_helper</a>().
<p>
<div class="fragment"><pre>01899                                              {
01900     <font class="keywordflow">while</font>(requests) {
01901         <a class="code" href="snmp__agent_8h.html#a39">set_request_error</a>(reqinfo, requests, error_value);
01902         requests = requests-&gt;<a class="code" href="structrequest__info__s.html#m8">next</a>;
01903     }
01904     <font class="keywordflow">return</font> error_value;
01905 }
</pre></div>    </td>
  </tr>
</table>
<a name="a38" doxytag="snmp_agent.h::set_mode_request_error"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int set_mode_request_error </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>mode</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a18">request_info</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>request</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>error_value</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01853">1853</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="snmp__agent_8c-source.html#l01845">set_request_error</a>().
<p>
<div class="fragment"><pre>01854                                         {
01855     <font class="keywordflow">if</font> (!request)
01856         <font class="keywordflow">return</font> error_value;
01857 
01858     request-&gt;<a class="code" href="structrequest__info__s.html#m5">processed</a> = 1;
01859 
01860     <font class="keywordflow">switch</font>(error_value) {
01861         <font class="keywordflow">case</font> SNMP_NOSUCHOBJECT:
01862         <font class="keywordflow">case</font> SNMP_NOSUCHINSTANCE:
01863         <font class="keywordflow">case</font> SNMP_ENDOFMIBVIEW:
01864             <font class="comment">/* these are exceptions that should be put in the varbind</font>
01865                in the case of a GET but should be translated for a SET
01866                into a real error status code and put in the request */
01867             <font class="keywordflow">switch</font> (mode) {
01868                 <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a4">MODE_GET</a>:
01869                     request-&gt;<a class="code" href="structrequest__info__s.html#m0">requestvb</a>-&gt;type = error_value;
01870                     <font class="keywordflow">return</font> error_value;
01871                     
01872                 <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a5">MODE_GETNEXT</a>:
01873                 <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a6">MODE_GETBULK</a>:
01874                     <font class="comment">/* ignore these.  They're illegal to set by the</font>
01875                        client APIs for these modes */
01876                     <font class="keywordflow">return</font> error_value;
01877 
01878                 <font class="keywordflow">default</font>:
01879                     request-&gt;<a class="code" href="structrequest__info__s.html#m6">status</a> = SNMP_ERR_NOSUCHNAME; <font class="comment">/* WWW: correct? */</font>
01880                     <font class="keywordflow">return</font> error_value;
01881             }
01882             <font class="keywordflow">break</font>; <font class="comment">/* never get here */</font>
01883 
01884         <font class="keywordflow">default</font>:
01885             <font class="keywordflow">if</font> (request-&gt;<a class="code" href="structrequest__info__s.html#m6">status</a> &lt; 0) {
01886                 <font class="comment">/* illegal local error code.  translate to generr */</font>
01887                 <font class="comment">/* WWW: full translation map? */</font>
01888                 request-&gt;<a class="code" href="structrequest__info__s.html#m6">status</a> = SNMP_ERR_GENERR;
01889             } <font class="keywordflow">else</font> {
01890                 <font class="comment">/* WWW: translations and mode checking? */</font>
01891                 request-&gt;<a class="code" href="structrequest__info__s.html#m6">status</a> = error_value;
01892             }
01893             <font class="keywordflow">return</font> error_value;
01894     }
01895     <font class="keywordflow">return</font> error_value;
01896 }
</pre></div>    </td>
  </tr>
</table>
<a name="a39" doxytag="snmp_agent.h::set_request_error"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int set_request_error </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>reqinfo</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a18">request_info</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>request</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>error_value</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01845">1845</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="agent__handler_8c-source.html#l00070">call_handlers</a>(), <a class="el" href="table__array_8c-source.html#l00341">group_requests</a>(), <a class="el" href="instance_8c-source.html#l00170">instance_counter32_handler</a>(), <a class="el" href="instance_8c-source.html#l00260">instance_helper_handler</a>(), <a class="el" href="instance_8c-source.html#l00199">instance_long_handler</a>(), <a class="el" href="instance_8c-source.html#l00109">instance_ulong_handler</a>(), <a class="el" href="old__api_8c-source.html#l00097">old_api_helper</a>(), <a class="el" href="table__array_8c-source.html#l00243">process_get_requests</a>(), <a class="el" href="snmp__agent_8c-source.html#l01898">set_all_requests_error</a>(), <a class="el" href="table__dataset_8c-source.html#l00221">table_data_set_helper_handler</a>(), and <a class="el" href="table_8c-source.html#l00135">table_helper_handler</a>().
<p>
<div class="fragment"><pre>01846                                         {
01847     <font class="keywordflow">if</font> (!request || !reqinfo)
01848         <font class="keywordflow">return</font> error_value;
01849 
01850     <font class="keywordflow">return</font> <a class="code" href="snmp__agent_8h.html#a38">set_mode_request_error</a>(reqinfo-&gt;<a class="code" href="structagent__request__info__s.html#m0">mode</a>, request, error_value);
01851 }
</pre></div>    </td>
  </tr>
</table>
<a name="a23" doxytag="snmp_agent.h::snmp_addrcache_age"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void snmp_addrcache_age </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l00325">325</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.<div class="fragment"><pre>00326 {
00327   <font class="keywordtype">int</font> i = 0;
00328   
00329   lastAddrAge = 0;
00330   <font class="keywordflow">for</font> (i = 0; i &lt; <a class="code" href="snmp__agent_8c.html#a1">SNMP_ADDRCACHE_SIZE</a>; i++) {
00331     <font class="keywordflow">if</font> (<a class="code" href="structaddrCache.html">addrCache</a>[i].status == SNMP_ADDRCACHE_OLD) {
00332       <a class="code" href="structaddrCache.html">addrCache</a>[i].status = SNMP_ADDRCACHE_UNUSED;
00333       <font class="keywordflow">if</font> (<a class="code" href="structaddrCache.html">addrCache</a>[i].addr != NULL) {
00334         free(<a class="code" href="structaddrCache.html">addrCache</a>[i].addr);
00335         <a class="code" href="structaddrCache.html">addrCache</a>[i].addr = NULL;
00336       }
00337     }
00338     <font class="keywordflow">if</font> (<a class="code" href="structaddrCache.html">addrCache</a>[i].status == SNMP_ADDRCACHE_USED) {
00339       <a class="code" href="structaddrCache.html">addrCache</a>[i].status = SNMP_ADDRCACHE_OLD;
00340     }
00341   }
00342 }
</pre></div>    </td>
  </tr>
</table>
<a name="a22" doxytag="snmp_agent.h::snmp_addrcache_initialise"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void snmp_addrcache_initialise </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>void&nbsp;</td>
          <td class="mdname1">&nbsp;          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l00311">311</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.<div class="fragment"><pre>00312 {
00313   <font class="keywordtype">int</font> i = 0;
00314   
00315   <font class="keywordflow">for</font> (i = 0; i &lt; <a class="code" href="snmp__agent_8c.html#a1">SNMP_ADDRCACHE_SIZE</a>; i++) {
00316     <a class="code" href="structaddrCache.html">addrCache</a>[i].addr = NULL;
00317     <a class="code" href="structaddrCache.html">addrCache</a>[i].status = SNMP_ADDRCACHE_UNUSED;
00318   }
00319 }
</pre></div>    </td>
  </tr>
</table>
<a name="a28" doxytag="snmp_agent.h::snmp_agent_parse_config"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void snmp_agent_parse_config </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname">&nbsp;, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname">&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a45" doxytag="snmp_agent.h::snmp_check_packet"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int snmp_check_packet </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct snmp_session *&nbsp;</td>
          <td class="mdname">&nbsp;, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct _snmp_transport *&nbsp;</td>
          <td class="mdname">&nbsp;, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname">&nbsp;, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a46" doxytag="snmp_agent.h::snmp_check_parse"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int snmp_check_parse </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct snmp_session *&nbsp;</td>
          <td class="mdname">&nbsp; <em>session</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct snmp_pdu *&nbsp;</td>
          <td class="mdname">&nbsp; <em>pdu</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>result</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a42" doxytag="snmp_agent.h::timeval_uptime"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int timeval_uptime </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>struct timeval *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>tv</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8c-source.html#l01921">1921</a> of file <a class="el" href="snmp__agent_8c-source.html">snmp_agent.c</a>.
<p>
Referenced by <a class="el" href="snmp__agent_8c-source.html#l01928">get_agent_uptime</a>().
<p>
<div class="fragment"><pre>01922 {
01923     <font class="keywordflow">return</font> <a class="code" href="snmp__agent_8h.html#a41">marker_uptime</a>((marker_t)tv);
01924 }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a name="a17" doxytag="snmp_agent.h::lastAddrAge"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int lastAddrAge
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00028">28</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<a name="a16" doxytag="snmp_agent.h::log_addresses"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int log_addresses
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="snmp__agent_8h-source.html#l00024">24</a> of file <a class="el" href="snmp__agent_8h-source.html">snmp_agent.h</a>.    </td>
  </tr>
</table>
<hr><address><small>Generated on Sat Nov 10 14:09:56 2001 for net-snmp by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.11 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
<!--#include virtual="/sfbutton.html" -->
<!--#include virtual="/sfbutton.html" -->
<!-- CONTENT END -->