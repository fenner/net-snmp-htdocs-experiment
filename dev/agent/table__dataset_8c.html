---
section: development
---
<!-- CONTENT START -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>table_dataset.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>table_dataset.c File Reference</h1><code>#include &lt;<a class="el" href="config_8h-source.html">config.h</a>&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include "mibincl.h"</code><br>
<code>#include "<a class="el" href="table_8h-source.html">table.h</a>"</code><br>
<code>#include "<a class="el" href="table__data_8h-source.html">table_data.h</a>"</code><br>
<code>#include "<a class="el" href="table__dataset_8h-source.html">table_dataset.h</a>"</code><br>
<code>#include "parse.h"</code><br>
<code>#include "data_list.h"</code><br>
<code>#include &lt;dmalloc.h&gt;</code><br>

<p>
<a href="table__dataset_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Data Structures</h2></td></tr>
<tr><td nowrap align=right valign=top>struct &nbsp;</td><td valign=bottom><a class="el" href="structdata__set__cache__s.html">data_set_cache_s</a></td></tr>
<tr><td nowrap align=right valign=top>struct &nbsp;</td><td valign=bottom><a class="el" href="structdata__set__tables__s.html">data_set_tables_s</a></td></tr>
<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td nowrap align=right valign=top>typedef <a class="el" href="structdata__set__tables__s.html">data_set_tables_s</a>&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a1">data_set_tables</a></td></tr>
<tr><td nowrap align=right valign=top>typedef <a class="el" href="structdata__set__cache__s.html">data_set_cache_s</a>&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a2">data_set_cache</a></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a3">create_table_data_set</a> (const char *table_name)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Create a table_data_set structure given a table_data definition.</em> <a href="#a3">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="helpers_2agent__handler_8h.html#a8">mib_handler</a> *&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a4">get_table_data_set_handler</a> (<a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *data_set)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Given a table_data_set definition, create a handler for it.</em> <a href="#a4">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a5">register_table_data_set</a> (<a class="el" href="helpers_2agent__handler_8h.html#a9">handler_registration</a> *reginfo, <a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *data_set, <a class="el" href="table_8h.html#a11">table_registration_info</a> *table_info)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>register a given data_set at a given oid (specified in the handler_registration pointer).</em> <a href="#a5">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="table__dataset_8h.html#a2">table_data_set_storage</a> *&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a6">table_data_set_find_column</a> (<a class="el" href="table__dataset_8h.html#a2">table_data_set_storage</a> *start, int column)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Finds a column within a given storage set, given the pointer to the start of the storage set list.</em> <a href="#a6">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a7">extract_table_data_set</a> (<a class="el" href="snmp__agent_8h.html#a18">request_info</a> *request)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>extracts a table_data_set pointer from a given request.</em> <a href="#a7">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a8">mark_row_column_writable</a> (<a class="el" href="table__data_8h.html#a3">table_row</a> *row, int column, int writable)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>marks a given column in a row as writable or not.</em> <a href="#a8">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a9">set_row_column</a> (<a class="el" href="table__data_8h.html#a3">table_row</a> *row, unsigned int column, int type, const char *value, size_t value_len)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>sets a given column in a row with data given a type, value, and length.</em> <a href="#a9">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a10">table_set_add_default_row</a> (<a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *table_set, unsigned int column, int type, int writable)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>adds a new default row to a table_set.</em> <a href="#a10">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a11">table_data_set_helper_handler</a> (<a class="el" href="helpers_2agent__handler_8h.html#a8">mib_handler</a> *handler, <a class="el" href="helpers_2agent__handler_8h.html#a9">handler_registration</a> *reginfo, <a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *reqinfo, <a class="el" href="snmp__agent_8h.html#a18">request_info</a> *requests)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a12">config_parse_table_set</a> (const char *token, char *line)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a13">config_parse_add_row</a> (const char *token, char *line)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a14">table_dataset_add_index</a> (<a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *table, int type)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="table__dataset_8c.html#a15">table_dataset_add_row</a> (<a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *table, <a class="el" href="table__data_8h.html#a3">table_row</a> *row)</td></tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a name="a2" doxytag="table_dataset.c::data_set_cache"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="structdata__set__cache__s.html">data_set_cache_s</a>  data_set_cache
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a1" doxytag="table_dataset.c::data_set_tables"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="structdata__set__tables__s.html">data_set_tables_s</a>  data_set_tables
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a name="a13" doxytag="table_dataset.c::config_parse_add_row"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void config_parse_add_row </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>token</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>line</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00467">467</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00468 {
00469     <font class="keywordtype">char</font> buf[SNMP_MAXBUF_MEDIUM];
00470     <font class="keywordtype">char</font> tname[SNMP_MAXBUF_MEDIUM];
00471     size_t buf_size;
00472 
00473     <a class="code" href="structdata__set__tables__s.html">data_set_tables</a> *tables;
00474     <font class="keyword">struct </font>variable_list *vb; <font class="comment">/* containing only types */</font>
00475     <a class="code" href="structtable__row__s.html">table_row</a> *row;
00476     <a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a> *dr;
00477     
00478     line = copy_nword(line, tname, SNMP_MAXBUF_MEDIUM);
00479 
00480     tables = (<a class="code" href="structdata__set__tables__s.html">data_set_tables</a> *) get_list_data(auto_tables, tname);
00481     <font class="keywordflow">if</font> (!tables) {
00482         config_pwarn(<font class="stringliteral">"Unknown table trying to add a row"</font>);
00483         <font class="keywordflow">return</font>;
00484     }
00485 
00486     <font class="comment">/* do the indexes first */</font>
00487     row = <a class="code" href="table__data_8c.html#a9">create_table_data_row</a>();
00488 
00489     <font class="keywordflow">for</font>(vb = tables-&gt;<a class="code" href="structdata__set__tables__s.html#m0">table_set</a>-&gt;table-&gt;indexes_template; vb;
00490         vb = vb-&gt;next_variable) {
00491         <font class="keywordflow">if</font> (!line) {
00492             config_pwarn(<font class="stringliteral">"missing an index value"</font>);
00493             <font class="keywordflow">return</font>;
00494         }
00495         
00496         DEBUGMSGTL((<font class="stringliteral">"table_set_add_row"</font>,<font class="stringliteral">"adding index of type %d\n"</font>, vb-&gt;type));
00497         buf_size = SNMP_MAXBUF_MEDIUM;
00498         line = read_config_read_memory(vb-&gt;type, line, buf, &amp;buf_size);
00499         <a class="code" href="table__data_8h.html#a2">table_row_add_index</a>(row, vb-&gt;type, buf, buf_size);
00500     }
00501 
00502     <font class="comment">/* then do the data */</font>
00503     <font class="keywordflow">for</font>(dr = tables-&gt;<a class="code" href="structdata__set__tables__s.html#m0">table_set</a>-&gt;default_row; dr; dr = dr-&gt;<a class="code" href="structtable__data__set__storage__s.html#m12">next</a>) {
00504         <font class="keywordflow">if</font> (!line) {
00505             config_pwarn(<font class="stringliteral">"missing an data value\n"</font>);
00506             <font class="keywordflow">return</font>;
00507         }
00508         
00509         buf_size = SNMP_MAXBUF_MEDIUM;
00510         line = read_config_read_memory(dr-&gt;<a class="code" href="structtable__data__set__storage__s.html#m2">type</a>, line, buf, &amp;buf_size);
00511         DEBUGMSGTL((<font class="stringliteral">"table_set_add_row"</font>,<font class="stringliteral">"adding data at column %d of type %d\n"</font>, dr-&gt;<a class="code" href="structtable__data__set__storage__s.html#m0">column</a>, dr-&gt;<a class="code" href="structtable__data__set__storage__s.html#m2">type</a>));
00512         <a class="code" href="table__dataset_8h.html#a7">set_row_column</a>(row, dr-&gt;<a class="code" href="structtable__data__set__storage__s.html#m0">column</a>, dr-&gt;<a class="code" href="structtable__data__set__storage__s.html#m2">type</a>, buf, buf_size);
00513         <font class="keywordflow">if</font> (dr-&gt;<a class="code" href="structtable__data__set__storage__s.html#m1">writable</a>)
00514             <a class="code" href="table__dataset_8h.html#a12">mark_row_column_writable</a>(row, dr-&gt;<a class="code" href="structtable__data__set__storage__s.html#m0">column</a>, 1); <font class="comment">/* make writable */</font>
00515     }
00516     <a class="code" href="table__data_8h.html#a8">table_data_add_row</a>(tables-&gt;<a class="code" href="structdata__set__tables__s.html#m0">table_set</a>-&gt;table, row);
00517 }
</pre></div>    </td>
  </tr>
</table>
<a name="a12" doxytag="table_dataset.c::config_parse_table_set"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void config_parse_table_set </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>token</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>line</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00372">372</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00373 {
00374     oid name[MAX_OID_LEN], table_name[MAX_OID_LEN];
00375     size_t name_length = MAX_OID_LEN, table_name_length = MAX_OID_LEN;
00376     <font class="keyword">struct </font>tree *tp, *indexnode;
00377     <a class="code" href="structtable__data__set__s.html">table_data_set</a> *table_set;
00378     <font class="keyword">struct </font>index_list *index;
00379     <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> mincol = 0xffffff, maxcol = 0;
00380     <a class="code" href="structdata__set__tables__s.html">data_set_tables</a> *tables;
00381     <font class="keywordtype">int</font> type;
00382     
00383     <font class="comment">/* instatiate a fake table based on MIB information */</font>
00384     <font class="keywordflow">if</font> (!snmp_parse_oid(line, table_name, &amp;table_name_length) ||
00385         (NULL == (tp = get_tree(table_name, table_name_length,
00386                                 get_tree_head()))))<font class="keyword"> </font>{
00387         config_pwarn(<font class="stringliteral">"can't instatiate table %s since I can't find mib information about it\n"</font>);
00388         <font class="keywordflow">return</font>;
00389     }
00390 
00391     <font class="keywordflow">if</font> (NULL == (tp = tp-&gt;child_list) ||
00392         NULL == tp-&gt;child_list) {
00393         config_pwarn(<font class="stringliteral">"can't instatiate table since it doesn't appear to be a proper table\n"</font>);
00394         <font class="keywordflow">return</font>;
00395     }
00396 
00397     table_set = <a class="code" href="table__dataset_8h.html#a11">create_table_data_set</a>(line);
00398 
00399     <font class="comment">/* loop through indexes and add types */</font>
00400     <font class="keywordflow">for</font>(index = tp-&gt;indexes; index; index = index-&gt;next) {
00401         <font class="keywordflow">if</font> (!snmp_parse_oid(index-&gt;ilabel, name, &amp;name_length) ||
00402             (NULL == (indexnode = get_tree(name, name_length, get_tree_head()))))<font class="keyword"> </font>{
00403             config_pwarn(<font class="stringliteral">"can't instatiate table %s since I don't know anything about one index\n"</font>);
00404             <font class="keywordflow">return</font>; <font class="comment">/* xxx mem leak */</font>
00405         }
00406 
00407         type = mib_to_asn_type(indexnode-&gt;type);
00408         <font class="keywordflow">if</font> (type == -1) {
00409             config_pwarn(<font class="stringliteral">"unknown index type"</font>);
00410             <font class="keywordflow">return</font>; <font class="comment">/* xxx mem leak */</font>
00411         }
00412         <font class="keywordflow">if</font> (index-&gt;isimplied) <font class="comment">/* if implied, mark it as such */</font>
00413             type |= ASN_PRIVATE;
00414             
00415         DEBUGMSGTL((<font class="stringliteral">"table_set_add_row"</font>,<font class="stringliteral">"adding default index of type %d\n"</font>,
00416                     type));
00417         <a class="code" href="table__dataset_8h.html#a16">table_dataset_add_index</a>(table_set, type);
00418     }
00419 
00420     <font class="comment">/* loop through children and add each column info */</font>
00421     <font class="keywordflow">for</font>(tp = tp-&gt;child_list; tp; tp = tp-&gt;next_peer) {
00422         <font class="keywordtype">int</font> canwrite = 0;
00423         type = mib_to_asn_type(tp-&gt;type);
00424         <font class="keywordflow">if</font> (type == -1) {
00425             config_pwarn(<font class="stringliteral">"unknown column type"</font>);
00426             <font class="keywordflow">return</font>; <font class="comment">/* xxx mem leak */</font>
00427         }
00428         
00429         DEBUGMSGTL((<font class="stringliteral">"table_set_add_row"</font>,<font class="stringliteral">"adding column %d of type %d\n"</font>,
00430                     tp-&gt;subid, type));
00431 
00432         <font class="keywordflow">switch</font> (tp-&gt;access) {
00433             <font class="keywordflow">case</font> MIB_ACCESS_CREATE:
00434             <font class="keywordflow">case</font> MIB_ACCESS_READWRITE:
00435             <font class="keywordflow">case</font> MIB_ACCESS_WRITEONLY:
00436                 canwrite = 1;
00437             <font class="keywordflow">case</font> MIB_ACCESS_READONLY:
00438                 DEBUGMSGTL((<font class="stringliteral">"table_set_add_row"</font>,<font class="stringliteral">"adding column %d of type %d\n"</font>,
00439                             tp-&gt;subid, type));
00440                 <a class="code" href="table__dataset_8h.html#a6">table_set_add_default_row</a>(table_set, tp-&gt;subid, type, canwrite);
00441                 mincol = SNMP_MIN(mincol, tp-&gt;subid);
00442                 maxcol = SNMP_MAX(maxcol, tp-&gt;subid);
00443                 <font class="keywordflow">break</font>;
00444 
00445             <font class="keywordflow">case</font> MIB_ACCESS_NOACCESS:
00446             <font class="keywordflow">case</font> MIB_ACCESS_NOTIFY:
00447                 <font class="keywordflow">break</font>;
00448 
00449             <font class="keywordflow">default</font>:
00450                 config_pwarn(<font class="stringliteral">"unknown column access type"</font>);
00451                 <font class="keywordflow">break</font>;
00452         }
00453     }
00454 
00455     <font class="comment">/* register the table */</font>
00456     <a class="code" href="table__dataset_8h.html#a9">register_table_data_set</a>(
00457         <a class="code" href="helpers_2agent__handler_8h.html#a20">create_handler_registration</a>(line, NULL, table_name, table_name_length,
00458                                     HANDLER_CAN_RWRITE),
00459         table_set, NULL);
00460 
00461     tables = SNMP_MALLOC_TYPEDEF(<a class="code" href="structdata__set__tables__s.html">data_set_tables</a>);
00462     tables-&gt;<a class="code" href="structdata__set__tables__s.html#m0">table_set</a> = table_set;
00463     add_list_data(&amp;auto_tables, create_data_list(line, tables, NULL));
00464 }
</pre></div>    </td>
  </tr>
</table>
<a name="a3" doxytag="table_dataset.c::create_table_data_set"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="table__dataset_8h.html#a3">table_data_set</a>* create_table_data_set </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>table_name</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a table_data_set structure given a table_data definition.
<p>

<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00033">33</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00034 {
00035     <a class="code" href="structtable__data__set__s.html">table_data_set</a> *table_set = SNMP_MALLOC_TYPEDEF(<a class="code" href="structtable__data__set__s.html">table_data_set</a>);
00036     table_set-&gt;<a class="code" href="structtable__data__set__s.html#m0">table</a> = <a class="code" href="table__data_8h.html#a16">create_table_data</a>(table_name);
00037     <font class="keywordflow">return</font> table_set;
00038 }
</pre></div>    </td>
  </tr>
</table>
<a name="a7" doxytag="table_dataset.c::extract_table_data_set"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="table__dataset_8h.html#a3">table_data_set</a>* extract_table_data_set </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a18">request_info</a> *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>request</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
extracts a table_data_set pointer from a given request.
<p>

<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00114">114</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00115 {
00116     <font class="keywordflow">return</font> (<a class="code" href="structtable__data__set__s.html">table_data_set</a> *)
00117         <a class="code" href="helpers_2agent__handler_8h.html#a24">request_get_list_data</a>(request, <a class="code" href="table__dataset_8h.html#a0">TABLE_DATA_SET_NAME</a>);
00118 }
</pre></div>    </td>
  </tr>
</table>
<a name="a4" doxytag="table_dataset.c::get_table_data_set_handler"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="helpers_2agent__handler_8h.html#a8">mib_handler</a>* get_table_data_set_handler </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *&nbsp;</td>
          <td class="mdname1">&nbsp; <em>data_set</em>          </td>
          <td class="md">)&nbsp;</td>
          <td class="md"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Given a table_data_set definition, create a handler for it.
<p>

<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00042">42</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00043 {
00044     <a class="code" href="structmib__handler__s.html">mib_handler</a> *ret = NULL;
00045 
00046     <font class="keywordflow">if</font> (!data_set) {
00047         snmp_log(LOG_INFO, <font class="stringliteral">"get_table_data_set_handler(NULL) called\n"</font>);
00048         <font class="keywordflow">return</font> NULL;
00049     }
00050     
00051     ret = <a class="code" href="helpers_2agent__handler_8h.html#a19">create_handler</a>(<a class="code" href="table__dataset_8h.html#a0">TABLE_DATA_SET_NAME</a>, table_data_set_helper_handler);
00052     <font class="keywordflow">if</font> (ret) {
00053         ret-&gt;<a class="code" href="structmib__handler__s.html#m1">myvoid</a> = (<font class="keywordtype">void</font> *) data_set;
00054     }
00055     <font class="keywordflow">return</font> ret;
00056 }
</pre></div>    </td>
  </tr>
</table>
<a name="a8" doxytag="table_dataset.c::mark_row_column_writable"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int mark_row_column_writable </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="table__data_8h.html#a3">table_row</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>row</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>column</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>writable</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
marks a given column in a row as writable or not.
<p>

<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00124">124</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00125 {
00126     <a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a> *data = (<a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a> *) row-&gt;<a class="code" href="structtable__row__s.html#m3">data</a>;
00127     data = <a class="code" href="table__dataset_8h.html#a8">table_data_set_find_column</a>(data, column);
00128 
00129     <font class="keywordflow">if</font> (!data) {
00130         <font class="comment">/* create it */</font>
00131         data = SNMP_MALLOC_TYPEDEF(<a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a>);
00132         <font class="keywordflow">if</font> (!data) {
00133             snmp_log(LOG_CRIT, <font class="stringliteral">"no memory in set_row_column"</font>);
00134             <font class="keywordflow">return</font> SNMPERR_MALLOC;
00135         }
00136         data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m0">column</a> = column;
00137         data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m1">writable</a> = writable;
00138         data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m12">next</a> = row-&gt;<a class="code" href="structtable__row__s.html#m3">data</a>;
00139         row-&gt;<a class="code" href="structtable__row__s.html#m3">data</a> = data;
00140     } <font class="keywordflow">else</font> {
00141         data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m1">writable</a> = writable;
00142     }
00143     <font class="keywordflow">return</font> SNMPERR_SUCCESS;
00144 }
</pre></div>    </td>
  </tr>
</table>
<a name="a5" doxytag="table_dataset.c::register_table_data_set"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int register_table_data_set </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="helpers_2agent__handler_8h.html#a9">handler_registration</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>reginfo</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>data_set</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="table_8h.html#a11">table_registration_info</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>table_info</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
register a given data_set at a given oid (specified in the handler_registration pointer).
<p>
The reginfo-&gt;handler-&gt;access_method *may* be null if the call doesn't ever want to be called for SNMP operations. 
<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00065">65</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00067 {
00068     <font class="keywordflow">if</font> (NULL == table_info) {
00069         <font class="comment">/* allocate the table if one wasn't allocated */</font>
00070         table_info = SNMP_MALLOC_TYPEDEF(<a class="code" href="struct__table__registration__info.html">table_registration_info</a>);
00071     }
00072 
00073     <font class="keywordflow">if</font> (NULL == table_info-&gt;<a class="code" href="struct__table__registration__info.html#m0">indexes</a> &amp;&amp; data_set-&gt;<a class="code" href="structtable__data__set__s.html#m0">table</a>-&gt;indexes_template) {
00074         <font class="comment">/* copy the indexes in */</font>
00075         table_info-&gt;<a class="code" href="struct__table__registration__info.html#m0">indexes</a> =
00076             snmp_clone_varbind(data_set-&gt;<a class="code" href="structtable__data__set__s.html#m0">table</a>-&gt;indexes_template);
00077     }
00078     
00079     <font class="keywordflow">if</font> ((!table_info-&gt;<a class="code" href="struct__table__registration__info.html#m2">min_column</a> || !table_info-&gt;<a class="code" href="struct__table__registration__info.html#m3">max_column</a>) &amp;&amp;
00080         (data_set-&gt;<a class="code" href="structtable__data__set__s.html#m1">default_row</a>)) {
00081         <font class="comment">/* determine min/max columns */</font>
00082         <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> mincol = 0xffffffff, maxcol = 0;
00083         <a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a> *row;
00084         
00085         <font class="keywordflow">for</font>(row = data_set-&gt;<a class="code" href="structtable__data__set__s.html#m1">default_row</a>; row; row = row-&gt;<a class="code" href="structtable__data__set__storage__s.html#m12">next</a>) {
00086             mincol = SNMP_MIN(mincol, row-&gt;<a class="code" href="structtable__data__set__storage__s.html#m0">column</a>);
00087             maxcol = SNMP_MAX(maxcol, row-&gt;<a class="code" href="structtable__data__set__storage__s.html#m0">column</a>);
00088         }
00089         <font class="keywordflow">if</font> (!table_info-&gt;<a class="code" href="struct__table__registration__info.html#m2">min_column</a>)
00090             table_info-&gt;<a class="code" href="struct__table__registration__info.html#m2">min_column</a> = mincol;
00091         <font class="keywordflow">if</font> (!table_info-&gt;<a class="code" href="struct__table__registration__info.html#m3">max_column</a>)
00092             table_info-&gt;<a class="code" href="struct__table__registration__info.html#m3">max_column</a> = maxcol;
00093     }
00094 
00095     <a class="code" href="helpers_2agent__handler_8h.html#a13">inject_handler</a>(reginfo, <a class="code" href="table__dataset_8h.html#a10">get_table_data_set_handler</a>(data_set));
00096     <font class="keywordflow">return</font> <a class="code" href="table__data_8h.html#a12">register_table_data</a>(reginfo, data_set-&gt;<a class="code" href="structtable__data__set__s.html#m0">table</a>, table_info);
00097 }
</pre></div>    </td>
  </tr>
</table>
<a name="a9" doxytag="table_dataset.c::set_row_column"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int set_row_column </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="table__data_8h.html#a3">table_row</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>row</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname">&nbsp; <em>column</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>type</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname">&nbsp; <em>value</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname">&nbsp; <em>value_len</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
sets a given column in a row with data given a type, value, and length.
<p>
Data is memdup'ed by the function. 
<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00152">152</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00154 {
00155     <a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a> *data = (<a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a> *) row-&gt;<a class="code" href="structtable__row__s.html#m3">data</a>;
00156     data = <a class="code" href="table__dataset_8h.html#a8">table_data_set_find_column</a>(data, column);
00157 
00158     <font class="keywordflow">if</font> (!data) {
00159         <font class="comment">/* create it */</font>
00160         data = SNMP_MALLOC_TYPEDEF(<a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a>);
00161         <font class="keywordflow">if</font> (!data) {
00162             snmp_log(LOG_CRIT, <font class="stringliteral">"no memory in set_row_column"</font>);
00163             <font class="keywordflow">return</font> SNMPERR_MALLOC;
00164         }
00165         
00166         data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m0">column</a> = column;
00167         data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m2">type</a> = type;
00168         data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m12">next</a> = row-&gt;<a class="code" href="structtable__row__s.html#m3">data</a>;
00169         row-&gt;<a class="code" href="structtable__row__s.html#m3">data</a> = data;
00170     }
00171     
00172     <font class="keywordflow">if</font> (data) {
00173         <font class="keywordflow">if</font> (data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m2">type</a> != type)
00174             <font class="keywordflow">return</font> SNMPERR_GENERR;
00175         
00176         SNMP_FREE(data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m10">data</a>.<a class="code" href="structtable__data__set__storage__s.html#m4">voidp</a>);
00177         <font class="keywordflow">if</font> (memdup(&amp;data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m10">data</a>.<a class="code" href="structtable__data__set__storage__s.html#m6">string</a>, value, value_len) != SNMPERR_SUCCESS)<font class="keyword"> </font>{
00178             snmp_log(LOG_CRIT, <font class="stringliteral">"no memory in set_row_column"</font>);
00179             <font class="keywordflow">return</font> SNMPERR_MALLOC;
00180         }
00181         data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m11">data_len</a> = value_len;
00182     }
00183     <font class="keywordflow">return</font> SNMPERR_SUCCESS;
00184 }
</pre></div>    </td>
  </tr>
</table>
<a name="a6" doxytag="table_dataset.c::table_data_set_find_column"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="table__dataset_8h.html#a2">table_data_set_storage</a>* table_data_set_find_column </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="table__dataset_8h.html#a2">table_data_set_storage</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>start</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>column</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Finds a column within a given storage set, given the pointer to the start of the storage set list.
<p>

<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00103">103</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00104 {
00105     <font class="keywordflow">while</font>(start &amp;&amp; start-&gt;<a class="code" href="structtable__data__set__storage__s.html#m0">column</a> != column)
00106         start = start-&gt;<a class="code" href="structtable__data__set__storage__s.html#m12">next</a>;
00107     <font class="keywordflow">return</font> start;
00108 }
</pre></div>    </td>
  </tr>
</table>
<a name="a11" doxytag="table_dataset.c::table_data_set_helper_handler"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int table_data_set_helper_handler </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="helpers_2agent__handler_8h.html#a8">mib_handler</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>handler</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="helpers_2agent__handler_8h.html#a9">handler_registration</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>reginfo</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a21">agent_request_info</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>reqinfo</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="snmp__agent_8h.html#a18">request_info</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>requests</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00221">221</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00225                                          {
00226 
00227     <a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a> *data = NULL;
00228     <a class="code" href="structtable__row__s.html">table_row</a> *row;
00229     <a class="code" href="struct__table__request__info.html">table_request_info</a> *table_info;
00230     <a class="code" href="structdata__set__cache__s.html">data_set_cache</a> *cache;
00231     <a class="code" href="structrequest__info__s.html">request_info</a> *request;
00232 
00233     DEBUGMSGTL((<font class="stringliteral">"table_data_set"</font>, <font class="stringliteral">"handler starting"</font>));
00234     <font class="keywordflow">for</font>(request = requests; request; request = request-&gt;<a class="code" href="structrequest__info__s.html#m8">next</a>) {
00235         <font class="keywordflow">if</font> (request-&gt;<a class="code" href="structrequest__info__s.html#m5">processed</a>)
00236             <font class="keywordflow">continue</font>;
00237 
00238         <font class="comment">/* extract our stored data and table info */</font>
00239         row = <a class="code" href="table__data_8h.html#a14">extract_table_row</a>(request);
00240         table_info = <a class="code" href="table_8h.html#a25">extract_table_info</a>(request);
00241 
00242         <font class="keywordflow">if</font> (row)
00243             data = (<a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a> *) row-&gt;<a class="code" href="structtable__row__s.html#m3">data</a>;
00244         <font class="keywordflow">if</font> (!row || !table_info || !data) {
00245             <font class="keywordflow">if</font> (<a class="code" href="snmp__agent_8h.html#a15">MODE_IS_SET</a>(reqinfo-&gt;<a class="code" href="structagent__request__info__s.html#m0">mode</a>))<font class="keyword"> </font>{
00246                 <font class="comment">/* ack */</font>
00247                 <font class="comment">/* XXXWWW creation */</font>
00248                 <a class="code" href="snmp__agent_8h.html#a39">set_request_error</a>(reqinfo, request, SNMP_ERR_NOSUCHNAME);
00249             }
00250             <font class="keywordflow">continue</font>;
00251         }
00252 
00253         data = <a class="code" href="table__dataset_8h.html#a8">table_data_set_find_column</a>(data, table_info-&gt;<a class="code" href="struct__table__request__info.html#m0">colnum</a>);
00254 
00255         <font class="keywordflow">switch</font>(reqinfo-&gt;<a class="code" href="structagent__request__info__s.html#m0">mode</a>) {
00256             <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a4">MODE_GET</a>:
00257             <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a5">MODE_GETNEXT</a>:
00258             <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a6">MODE_GETBULK</a>: <font class="comment">/* XXXWWW */</font>
00259                 <font class="keywordflow">if</font> (!data) {
00260                     <a class="code" href="structtable__row__s.html">table_row</a> *newrow;
00261                     <a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a> *newdata = NULL;
00262                     <font class="keywordtype">int</font> column = table_info-&gt;<a class="code" href="struct__table__request__info.html#m0">colnum</a>;
00263                     <a class="code" href="structtable__data__set__s.html">table_data_set</a> *datatable =
00264                         (<a class="code" href="structtable__data__set__s.html">table_data_set</a> *) handler-&gt;<a class="code" href="structmib__handler__s.html#m1">myvoid</a>;
00265 
00266                     <font class="keywordflow">while</font>(column &lt;= table_info-&gt;<a class="code" href="struct__table__request__info.html#m5">reg_info</a>-&gt;max_column) {
00267                         <font class="keywordflow">if</font> (column != table_info-&gt;<a class="code" href="struct__table__request__info.html#m0">colnum</a>) {
00268                             <font class="comment">/* start with a new row */</font>
00269                             row = datatable-&gt;<a class="code" href="structtable__data__set__s.html#m0">table</a>-&gt;first_row;
00270                         }
00271                         <font class="keywordflow">for</font>(newrow = row; newrow; newrow = newrow-&gt;<a class="code" href="structtable__row__s.html#m4">next</a>) {
00272                             newdata = (<a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a> *) newrow-&gt;<a class="code" href="structtable__row__s.html#m3">data</a>;
00273                             <font class="keywordflow">if</font> (newdata)
00274                                 newdata =
00275                                     <a class="code" href="table__dataset_8h.html#a8">table_data_set_find_column</a>(newdata,
00276                                                                column);
00277                             <font class="keywordflow">if</font> (newdata) {
00278                                 <font class="comment">/* this is it */</font>
00279                                 data = newdata;
00280                                 row = newrow;
00281                                 table_info-&gt;<a class="code" href="struct__table__request__info.html#m0">colnum</a> = column;
00282                                 <font class="keywordflow">goto</font> done;
00283                             }
00284                         }
00285                         column++;
00286                     }
00287                 }
00288           done:
00289                 <font class="keywordflow">if</font> (data)
00290                     <a class="code" href="table__data_8h.html#a18">table_data_build_result</a>(reginfo, reqinfo, request, row,
00291                                             table_info-&gt;<a class="code" href="struct__table__request__info.html#m0">colnum</a>,
00292                                             data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m2">type</a>,
00293                                             data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m10">data</a>.<a class="code" href="structtable__data__set__storage__s.html#m4">voidp</a>, data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m11">data_len</a>);
00294                 <font class="keywordflow">else</font> {
00295                     <font class="comment">/* deal with holes by going to the next data set</font>
00296                        in the row or possibly onward to new columns */
00297                     snmp_log(LOG_ERR, <font class="stringliteral">"ack\n"</font>);
00298                 }
00299                 <font class="keywordflow">break</font>;
00300 
00301             <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a9">MODE_SET_RESERVE1</a>:
00302                 <font class="keywordflow">if</font> (data) {
00303                     <font class="comment">/* modify existing */</font>
00304                     <font class="keywordflow">if</font> (!data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m1">writable</a>) {
00305                         <a class="code" href="snmp__agent_8h.html#a39">set_request_error</a>(reqinfo, request,
00306                                           SNMP_ERR_NOTWRITABLE);
00307                     } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (request-&gt;<a class="code" href="structrequest__info__s.html#m0">requestvb</a>-&gt;type != data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m2">type</a>) {
00308                         <a class="code" href="snmp__agent_8h.html#a39">set_request_error</a>(reqinfo, request,
00309                                           SNMP_ERR_WRONGTYPE);
00310                     }
00311                 } <font class="keywordflow">else</font> {
00312                     <font class="comment">/* XXXWWW: create data, possibly new row */</font>
00313                 }
00314                 <font class="keywordflow">break</font>;
00315 
00316             <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a10">MODE_SET_RESERVE2</a>:
00317                 <font class="keywordflow">if</font> (data) {
00318                     <font class="comment">/* cache old data for later undo */</font>
00319                     cache = SNMP_MALLOC_TYPEDEF(<a class="code" href="structdata__set__cache__s.html">data_set_cache</a>);
00320                     <font class="keywordflow">if</font> (!cache) {
00321                         <a class="code" href="snmp__agent_8h.html#a39">set_request_error</a>(reqinfo, request,
00322                                           SNMP_ERR_RESOURCEUNAVAILABLE);
00323                     } <font class="keywordflow">else</font> {
00324                         cache-&gt;<a class="code" href="structdata__set__cache__s.html#m0">data</a> = data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m10">data</a>.<a class="code" href="structtable__data__set__storage__s.html#m4">voidp</a>;
00325                         cache-&gt;<a class="code" href="structdata__set__cache__s.html#m1">data_len</a> = data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m11">data_len</a>;
00326                         <a class="code" href="helpers_2agent__handler_8h.html#a23">request_add_list_data</a>(request, create_data_list(<a class="code" href="table__dataset_8h.html#a0">TABLE_DATA_SET_NAME</a>, cache, free));
00327                     }
00328                 } <font class="keywordflow">else</font> {
00329                     <font class="comment">/* XXXWWW */</font>
00330                 }
00331                 <font class="keywordflow">break</font>;
00332 
00333             <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a11">MODE_SET_ACTION</a>:
00334                 <font class="keywordflow">if</font> (data) {
00335                     memdup(&amp;data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m10">data</a>.<a class="code" href="structtable__data__set__storage__s.html#m6">string</a>, request-&gt;<a class="code" href="structrequest__info__s.html#m0">requestvb</a>-&gt;val.string,
00336                            request-&gt;<a class="code" href="structrequest__info__s.html#m0">requestvb</a>-&gt;val_len);
00337                     data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m11">data_len</a> = request-&gt;<a class="code" href="structrequest__info__s.html#m0">requestvb</a>-&gt;val_len;
00338                 } <font class="keywordflow">else</font> {
00339                     <font class="comment">/* XXXWWW */</font>
00340                 }
00341                 <font class="keywordflow">break</font>;
00342                 
00343             <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a14">MODE_SET_UNDO</a>:
00344                 SNMP_FREE(data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m10">data</a>.<a class="code" href="structtable__data__set__storage__s.html#m4">voidp</a>);
00345                 
00346                 cache = (<a class="code" href="structdata__set__cache__s.html">data_set_cache</a> *)
00347                     <a class="code" href="helpers_2agent__handler_8h.html#a24">request_get_list_data</a>(request, <a class="code" href="table__dataset_8h.html#a0">TABLE_DATA_SET_NAME</a>);
00348                 data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m10">data</a>.<a class="code" href="structtable__data__set__storage__s.html#m4">voidp</a> = cache-&gt;<a class="code" href="structdata__set__cache__s.html#m0">data</a>;
00349                 data-&gt;<a class="code" href="structtable__data__set__storage__s.html#m11">data_len</a> = cache-&gt;<a class="code" href="structdata__set__cache__s.html#m1">data_len</a>;
00350                 <font class="comment">/* the cache itself is automatically freed by the</font>
00351                    data_list routines */
00352                 <font class="keywordflow">break</font>;
00353 
00354             <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a12">MODE_SET_COMMIT</a>:
00355                 cache = (<a class="code" href="structdata__set__cache__s.html">data_set_cache</a> *)
00356                     <a class="code" href="helpers_2agent__handler_8h.html#a24">request_get_list_data</a>(request, <a class="code" href="table__dataset_8h.html#a0">TABLE_DATA_SET_NAME</a>);
00357                 SNMP_FREE(cache-&gt;<a class="code" href="structdata__set__cache__s.html#m0">data</a>);
00358                 <font class="keywordflow">break</font>;
00359 
00360             <font class="keywordflow">case</font> <a class="code" href="snmp__agent_8h.html#a13">MODE_SET_FREE</a>:
00361                 <font class="comment">/* nothing to do */</font>
00362                 <font class="keywordflow">break</font>;
00363         }
00364     }
00365 
00366     <font class="keywordflow">if</font> (handler-&gt;<a class="code" href="structmib__handler__s.html#m3">next</a> &amp;&amp; handler-&gt;<a class="code" href="structmib__handler__s.html#m3">next</a>-&gt;access_method)
00367         <a class="code" href="helpers_2agent__handler_8h.html#a18">call_next_handler</a>(handler, reginfo, reqinfo, requests);
00368     <font class="keywordflow">return</font> SNMP_ERR_NOERROR;
00369 }
</pre></div>    </td>
  </tr>
</table>
<a name="a14" doxytag="table_dataset.c::table_dataset_add_index"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void table_dataset_add_index </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>table</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>type</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00519">519</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00520 {
00521     <a class="code" href="table__data_8h.html#a1">table_data_add_index</a>(table-&gt;<a class="code" href="structtable__data__set__s.html#m0">table</a>, type);
00522 }
</pre></div>    </td>
  </tr>
</table>
<a name="a15" doxytag="table_dataset.c::table_dataset_add_row"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void table_dataset_add_row </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>table</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="table__data_8h.html#a3">table_row</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>row</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00524">524</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00525 {
00526     <a class="code" href="table__data_8h.html#a8">table_data_add_row</a>(table-&gt;<a class="code" href="structtable__data__set__s.html#m0">table</a>, row);
00527 }
</pre></div>    </td>
  </tr>
</table>
<a name="a10" doxytag="table_dataset.c::table_set_add_default_row"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int table_set_add_default_row </td>
          <td class="md">(&nbsp;</td>
          <td class="md" nowrap><a class="el" href="table__dataset_8h.html#a3">table_data_set</a> *&nbsp;</td>
          <td class="mdname">&nbsp; <em>table_set</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname">&nbsp; <em>column</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>type</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname">&nbsp; <em>writable</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
adds a new default row to a table_set.
<p>
returns SNMPERR_SUCCESS or SNMPERR_FAILURE 
<p>
Definition at line <a class="el" href="table__dataset_8c-source.html#l00191">191</a> of file <a class="el" href="table__dataset_8c-source.html">table_dataset.c</a>.<div class="fragment"><pre>00193 {
00194     
00195     <a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a> *new_col, *ptr;
00196 
00197     <font class="comment">/* double check */</font>
00198     new_col = <a class="code" href="table__dataset_8h.html#a8">table_data_set_find_column</a>(table_set-&gt;<a class="code" href="structtable__data__set__s.html#m1">default_row</a>, column);
00199     <font class="keywordflow">if</font> (new_col != NULL) {
00200         <font class="keywordflow">if</font> (new_col-&gt;<a class="code" href="structtable__data__set__storage__s.html#m2">type</a> == type &amp;&amp;
00201             new_col-&gt;<a class="code" href="structtable__data__set__storage__s.html#m1">writable</a> == writable)
00202             <font class="keywordflow">return</font> SNMPERR_SUCCESS;
00203         <font class="keywordflow">return</font> SNMPERR_GENERR;
00204     }
00205 
00206     new_col = SNMP_MALLOC_TYPEDEF(<a class="code" href="structtable__data__set__storage__s.html">table_data_set_storage</a>);
00207     new_col-&gt;<a class="code" href="structtable__data__set__storage__s.html#m2">type</a> = type;
00208     new_col-&gt;<a class="code" href="structtable__data__set__storage__s.html#m1">writable</a> = writable;
00209     new_col-&gt;<a class="code" href="structtable__data__set__storage__s.html#m0">column</a> = column;
00210     <font class="keywordflow">if</font> (table_set-&gt;<a class="code" href="structtable__data__set__s.html#m1">default_row</a> == NULL)
00211         table_set-&gt;<a class="code" href="structtable__data__set__s.html#m1">default_row</a> = new_col;
00212     <font class="keywordflow">else</font> {
00213         <font class="keywordflow">for</font>(ptr = table_set-&gt;<a class="code" href="structtable__data__set__s.html#m1">default_row</a>; ptr-&gt;<a class="code" href="structtable__data__set__storage__s.html#m12">next</a>; ptr = ptr-&gt;<a class="code" href="structtable__data__set__storage__s.html#m12">next</a>) {
00214         }
00215         ptr-&gt;<a class="code" href="structtable__data__set__storage__s.html#m12">next</a> = new_col;
00216     }
00217     <font class="keywordflow">return</font> SNMPERR_SUCCESS;
00218 }
</pre></div>    </td>
  </tr>
</table>
<hr><address><small>Generated on Sat Nov 10 14:09:57 2001 for net-snmp by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.11 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
<!--#include virtual="/sfbutton.html" -->
<!--#include virtual="/sfbutton.html" -->
<!-- CONTENT END -->